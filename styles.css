/* =========================================================
   PATCH: HUD XP = ONLY BAR (no text/labels)
   ========================================================= */

/* safety: ÑÐºÑ‰Ð¾ Ð´ÐµÑÑŒ Ð»Ð¸ÑˆÐ¸Ð²ÑÑ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¸Ð¹ Ð±Ð»Ð¾Ðº â€” ÑÑ…Ð¾Ð²Ð°Ñ‚Ð¸ */
.hud-xp-top,
.hud-xp-percent,
.hud-xp-text{
  display: none !important;
}

/* XP Ð¿Ñ–Ð´ Ð²Ð°Ð»ÑŽÑ‚Ð¾ÑŽ Ð½Ð° Ð²ÑÑŽ ÑˆÐ¸Ñ€Ð¸Ð½Ñƒ */
.hud-xp-under-currency{
  width: 100%;
  margin-top: 8px;
}

/* ÑÐ°Ð¼ Ñ‚Ñ€ÐµÐº Ð±Ð°Ñ€Ñƒ */
.hud-xp-bar{
  width: 100%;
  height: 10px;
  border-radius: 999px;
  overflow: hidden;
  background: linear-gradient(180deg, #0b0907, #050403);
  border: 1px solid rgba(242,208,122,0.25);
  box-shadow: inset 0 0 10px rgba(0,0,0,0.85);
}

/* fill (Ñƒ Ñ‚ÐµÐ±Ðµ Ð² HTML ÐºÐ»Ð°Ñ xp-bar-fill, Ñ‚Ð¾Ð¶ ÑÑ‚Ð¸Ð»Ñ–Ð·ÑƒÑ”Ð¼Ð¾ Ð¹Ð¾Ð³Ð¾ ÑÐ²Ð½Ð¾) */
.hud-xp-bar .xp-bar-fill{
  height: 100%;
  width: 0%;
  border-radius: 999px;
  transition: width 220ms ease;
  background: linear-gradient(
    90deg,
    #7a5520,
    #c59b3c 40%,
    #f2d07a 75%,
    #fff2c0
  );
  box-shadow: 0 0 12px rgba(242,208,122,0.45);
}

/* Combined CSS: steampunk-cards.css */

/* ===== TASKS UI (Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ– ÑÑ‚Ð¸Ð»Ñ–) ===== */
.task-claim-btn{
  background: linear-gradient(135deg,#c59b3c,#f2d07a);
  border:none;
  padding:6px 14px;
  border-radius:10px;
  font-weight:700;
  cursor:pointer;
}
.task-claimed{
  opacity:.5;
}


@media (max-width: 600px) {
  .duel-deck.mobile-grid {
    gap: 4px;
    max-width: 99vw;
  }
}

.duel-deck.mobile-grid .sp-card {
  min-width: 0;
  width: 100%;
  max-width: 117px;
  aspect-ratio: 3/4;
  height: auto; /* let aspect-ratio determine height */
  margin: 0;
  position: relative;
  align-self: center;
  justify-self: center;
}

/* Arrange duel cards into top and bottom rows (leave middle row empty) */
.duel-deck,
.duel-deck.mobile-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: auto auto auto; /* top, middle (empty), bottom */
  gap: 8px;
  justify-items: center;
  align-items: center;
}

.duel-deck .sp-card:nth-child(1) { grid-column: 1; grid-row: 1; }
.duel-deck .sp-card:nth-child(2) { grid-column: 2; grid-row: 1; }
.duel-deck .sp-card:nth-child(3) { grid-column: 3; grid-row: 1; }
.duel-deck .sp-card:nth-child(4) { grid-column: 1; grid-row: 3; }
.duel-deck .sp-card:nth-child(5) { grid-column: 2; grid-row: 3; }
.duel-deck .sp-card:nth-child(6) { grid-column: 3; grid-row: 3; }

/* Mirror rules for mobile-grid selector as well */
.duel-deck.mobile-grid .sp-card:nth-child(1) { grid-column: 1; grid-row: 1; }
.duel-deck.mobile-grid .sp-card:nth-child(2) { grid-column: 2; grid-row: 1; }
.duel-deck.mobile-grid .sp-card:nth-child(3) { grid-column: 3; grid-row: 1; }
.duel-deck.mobile-grid .sp-card:nth-child(4) { grid-column: 1; grid-row: 3; }
.duel-deck.mobile-grid .sp-card:nth-child(5) { grid-column: 2; grid-row: 3; }
.duel-deck.mobile-grid .sp-card:nth-child(6) { grid-column: 3; grid-row: 3; }

/* Make duel cards visually match the deck grid (sizes, padding, power plate) */
.duel-deck .sp-card,
.duel-deck.mobile-grid .sp-card {
  max-width: none;                 /* same as deck-grid */
  width: 100%;
  height: auto;
  aspect-ratio: 3 / 4.4;           /* tuned to match deck compact look */
  border-radius: 13px;
  padding: 0;
  overflow: hidden;
  contain: layout paint;
  transform: translateZ(0);
}

.duel-deck .sp-card::before,
.duel-deck.mobile-grid .sp-card::before {
  inset: 0;
  border-radius: 13px;
}

.duel-deck .sp-card::after,
.duel-deck.mobile-grid .sp-card::after {
  inset: 3px;
  border-radius: 11px;
}

.duel-deck .power-plate,
.duel-deck.mobile-grid .power-plate {
  height: 49px;
  bottom: 11px;
  border-radius: 9px;
  border-width: 1px;
}

.duel-deck .power-value,
.duel-deck.mobile-grid .power-value {
  font-size: clamp(1rem, 3.8vw, 1.4rem);
}

.card-multiplier {
  position: absolute;
  top: 3px;
  right: 7px;
  background: rgba(0,0,0,0.7);
  color: #fff;
  border-radius: 9px;
  padding: 2px 7px;
  font-size: 1.1rem;
  font-weight: bold;
  z-index: 2;
  pointer-events: none;
  box-shadow: 0 2px 8px #0005;
}
/* ðŸŽ´ Ð¡Ð¢Ð˜ÐœÐŸÐÐÐš Ð¡Ð¢Ð˜Ð›Ð¬ ÐšÐÐ Ð¢ - Ð”Ð•Ð¢ÐÐ›Ð¬ÐÐ˜Ð™ Ð”Ð˜Ð—ÐÐ™Ð */

:root {
  --bg0: #070504;
  --bg1: #120c08;
  --brass0: #f2d07a;
  --brass1: #c59b3c;
  --brass2: #7a5520;
  --ink: #f4e6c6;
  --shadow: rgba(0,0,0,.85);
  
  --fire: #c45a2a;
  --water: #3b6c8e;
  --air: #9fb6c1;
  --earth: #7a6a3a;
  
  --common: #b8a27b;
  --rare: #6fb2ff;
  --epic: #8a5ccf;
  --legend: #ffcc66;
  
  --rare-green: #3fbf6f;
  --rare-green-dark: #1f6b3f;
  
  --r1: #9e9e9e;   /* common / grey   */
  --r2: #4aa0d6;   /* blue            */
  --r3: #3fbf6f;   /* green (rare)    */
  --r4: #8a5ccf;   /* purple          */
  --r5: #ffd83a;   /* gold            */
  --r6: #c92a2a;   /* red / mythic    */
}

/* Hide textual rarity badges globally (removed per request) */
.rarity-badge,
.rarity {
  display: none !important;
  visibility: hidden !important;
  width: 0 !important;
  height: 0 !important;
  overflow: hidden !important;
  padding: 0 !important;
  margin: 0 !important;
  border: none !important;
}

/* ===== Ð‘ÐÐ—ÐžÐ’Ð† Ð¡Ð¢Ð˜Ð›Ð† ===== */
.sp-card {
  /* make cards responsive inside grids: take full column width and preserve aspect */
  width: 100%;
  max-width: var(--card-max-width);
  height: auto;
  aspect-ratio: var(--card-aspect);
  border-radius: var(--card-radius);
  position: relative;
  padding: var(--card-pad);
  overflow: var(--card-overflow);
  box-sizing: border-box;
  --elem: var(--fire);
  --rar: var(--legend);

  background:
    radial-gradient(circle at 25% 25%, rgba(255,220,140,.25) 0%, transparent 65%),
    radial-gradient(circle at 75% 75%, rgba(196,90,42,.15) 0%, transparent 65%),
    linear-gradient(135deg, rgba(0,0,0,.4) 0%, rgba(0,0,0,.8) 50%, rgba(0,0,0,.9) 100%),
    linear-gradient(180deg, #1b120c, #080604);

  box-shadow:
    0 25px 50px var(--shadow),
    inset 0 0 30px rgba(0,0,0,.9),
    0 0 30px color-mix(in srgb, var(--elem) 30%, transparent),
    0 0 0 1px color-mix(in srgb, var(--rar-border) 65%, rgba(0,0,0,.2));
  
  cursor: pointer;
  transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* disable hover theatrics on touch devices */
@media (hover: none){
  .sp-card{ animation: none !important; }
  .sp-card:hover{ transform: none; }
}

/* Responsive card sizes */
@media (max-width: 1024px) {
  .sp-card {
    width: var(--card-width-tablet);
    height: var(--card-height-tablet);
    border-radius: 18px;
    padding: 12px;
  }
  .element-emoji { font-size: 28px; }
}

@media (max-width: 420px) {
  .sp-card {
    border-radius: 12px;
    padding: 8px;
  }
  .element-emoji { font-size: 22px; }
  .power-plate .power-value { font-size: 0.95rem; }
}

/* ==============================
   RARE â€” Ð—Ð•Ð›Ð•ÐÐ Ð ÐÐœÐšÐ
   ============================== */

.sp-card.rare {
  --rar: var(--rare-green);
  --rar-border: var(--rare-green-dark);
}

.sp-card.rare:hover {
  box-shadow:
    0 20px 35px rgba(0,0,0,.9),
    inset 0 0 20px rgba(0,0,0,.9),
    0 0 35px rgba(63,191,111,.55),
    0 0 0 1px rgba(63,191,111,.8);
}

/* === GRID 3x3 tuning (425px) === */
/* applies when card is inside deck grid container */
#deckGrid .sp-card,
.deck-grid .sp-card {
  max-width: none;                 /* remove 240px cap */
  width: 100%;
  height: auto;                    /* let aspect-ratio decide */
  aspect-ratio: 3 / 4.4;           /* tuned for compact 3x3 */
  border-radius: 13px;
  padding: 7px;
  overflow: hidden;                /* stabilizes iOS scrolling */
  contain: layout paint;           /* prevent relayout jank */
  transform: translateZ(0);
}

#deckGrid .sp-card::before,
.deck-grid .sp-card::before {
  inset: 5px;
  border-radius: 11px;
}

#deckGrid .sp-card::after,
.deck-grid .sp-card::after {
  inset: 11px;
  border-radius: 9px;
}

#deckGrid .power-plate,
.deck-grid .power-plate{
  height: 49px;
  bottom: 11px;
  border-radius: 9px;
  border-width: 1px;
}

#deckGrid .power-value,
.deck-grid .power-value{
  font-size: clamp(1rem, 3.8vw, 1.4rem);
}

/* mobile: disable hover theatrics to avoid visual noise and jank */
@media (hover: none) {
  .sp-card:hover {
    transform: none;
    box-shadow:
      0 25px 50px var(--shadow),
      inset 0 0 30px rgba(0,0,0,.9),
      0 0 30px color-mix(in srgb, var(--elem) 30%, transparent),
      0 0 0 1px rgba(242,208,122,.15);
  }

  .sp-card { animation: none !important; }
  .element-emoji { animation: none !important; }
  .sp-card:hover .power-plate { height: 52px; transform: translateX(-50%); }
  .sp-card:hover .power-value { font-size: clamp(1rem, 3.8vw, 1.4rem); }
}

.sp-card:hover {
  transform: translateY(-6px) scale(1.03) rotateX(1deg) rotateY(0deg);
  box-shadow:
    0 20px 35px var(--shadow),
    inset 0 0 20px rgba(0,0,0,.9),
    0 0 30px color-mix(in srgb, var(--elem) 40%, transparent),
    0 0 0 1px color-mix(in srgb, var(--rar-border) 70%, rgba(255,255,255,.08));
}

/* ÐœÐµÑ‚Ð°Ð»ÐµÐ²Ð° Ñ€Ð°Ð¼ÐºÐ° Ð· Ñ‚ÐµÐºÑÑ‚ÑƒÑ€Ð¾ÑŽ */
.sp-card::before {
  content: "";
  position: absolute;
  inset: 9px;
  border-radius: 17px;
  background:
    repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(242,208,122,.03) 2px, rgba(242,208,122,.03) 4px),
    linear-gradient(135deg,
      color-mix(in srgb, var(--rar) 40%, rgba(242,208,122,.8)),
      color-mix(in srgb, var(--rar) 30%, rgba(181,106,51,.4)),
      color-mix(in srgb, var(--rar) 25%, rgba(122,85,32,.3)));
  
  box-shadow:
    inset 0 0 0 3px color-mix(in srgb, var(--rar-border) 65%, rgba(0,0,0,.6)),
    inset 0 0 30px rgba(0,0,0,.7),
    0 0 20px rgba(242,208,122,.1);
  pointer-events: none;
  opacity: .97;
  z-index: 1;
}

/* Ð’Ð½ÑƒÑ‚Ñ€Ñ–ÑˆÐ½Ñ Ð¿Ð»Ð°ÑˆÐºÐ° */
.sp-card::after {
  content: "";
  position: absolute;
  inset: 19px;
  border-radius: 15px;
  background:
    repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(255,255,255,.02) 1px, rgba(255,255,255,.02) 2px),
    radial-gradient(ellipse at 50% 30%, rgba(255,210,120,.12) 0%, transparent 70%),
    linear-gradient(180deg, rgba(255,210,120,.08) 0%, rgba(0,0,0,.5) 100%),
    linear-gradient(180deg, #2a1c14, #0f0905);
  
  box-shadow:
    inset 0 0 0 2px rgba(242,208,122,.2),
    inset 0 0 25px rgba(0,0,0,.8),
    inset 0 -5px 25px rgba(0,0,0,.6);
  pointer-events: none;
  z-index: 2;
}

/* ===== Ð•ÐœÐžÐ”Ð—Ð† Ð—ÐÐÐ§ÐšÐ˜ Ð¡Ð¢Ð˜Ð¥Ð†Ð™ ===== */
.element-emoji {
  font-size: 32px;
  position: relative;
  z-index: 6;
  transition: all 0.4s ease;
  filter:
    drop-shadow(0 0 15px color-mix(in srgb, var(--elem) 90%, transparent))
    drop-shadow(0 5px 15px rgba(0,0,0,.95))
    brightness(1.2)
    contrast(1.1);
  text-shadow: 0 0 20px color-mix(in srgb, var(--elem) 80%, transparent);
  animation: emoji-float 3s ease-in-out infinite;
}

@keyframes emoji-float {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-3px) scale(1.05); }
}

.sp-card:hover .element-emoji {
  transform: scale(1.4);
  filter:
    drop-shadow(0 0 25px color-mix(in srgb, var(--elem) 100%, transparent))
    drop-shadow(0 8px 20px rgba(0,0,0,.98))
    brightness(1.3)
    contrast(1.2);
  animation: emoji-hover 0.8s ease-in-out;
}

@keyframes emoji-hover {
  0% { transform: scale(1); }
  50% { transform: scale(1.6); }
  100% { transform: scale(1.4); }
}

/* Ð¡Ð¿ÐµÑ†Ð¸Ñ„Ñ–Ñ‡Ð½Ñ– Ð°Ð½Ñ–Ð¼Ð°Ñ†Ñ–Ñ— Ð´Ð»Ñ ÐºÐ¾Ð¶Ð½Ð¾Ð³Ð¾ ÐµÐ¼Ð¾Ð´Ð·Ñ– */
.fire-emoji {
  animation: fire-flicker 1.5s ease-in-out infinite;
}

@keyframes fire-flicker {
  0%, 100% { 
    transform: translateY(0) scale(1);
    filter: hue-rotate(0deg) brightness(1.2);
  }
  25% { 
    transform: translateY(-2px) scale(1.05);
    filter: hue-rotate(10deg) brightness(1.3);
  }
  75% { 
    transform: translateY(1px) scale(0.98);
    filter: hue-rotate(-5deg) brightness(1.1);
  }
}

.water-emoji {
  animation: water-drip 2s ease-in-out infinite;
}

@keyframes water-drip {
  0%, 100% { 
    transform: translateY(0) scale(1);
    filter: brightness(1.1);
  }
  50% { 
    transform: translateY(2px) scale(0.95);
    filter: brightness(1.3);
  }
}

.air-emoji {
  animation: air-spin 4s linear infinite;
}

@keyframes air-spin {
  0% { transform: rotate(0deg) scale(1); }
  25% { transform: rotate(90deg) scale(1.05); }
  50% { transform: rotate(180deg) scale(1); }
  75% { transform: rotate(270deg) scale(0.95); }
  100% { transform: rotate(360deg) scale(1); }
}

.earth-emoji {
  animation: earth-bounce 2.5s ease-in-out infinite;
}

@keyframes earth-bounce {
  0%, 100% { 
    transform: translateY(0) rotate(0deg);
    filter: brightness(1.1);
  }
  25% { 
    transform: translateY(-2px) rotate(-5deg);
    filter: brightness(1.2);
  }
  75% { 
    transform: translateY(1px) rotate(5deg);
    filter: brightness(1.15);
  }
}

/* ===== Ð—ÐÐšÐ›Ð•ÐŸÐšÐ˜ ===== */
.rivet {
  position: absolute;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.5), rgba(255,255,255,.2) 40%, transparent 70%),
    radial-gradient(circle at 70% 70%, rgba(0,0,0,.4), transparent 40%),
    linear-gradient(135deg, var(--brass0), var(--brass2));
  box-shadow: 
    0 3px 10px rgba(0,0,0,.8),
    inset 0 0 0 2px rgba(0,0,0,.7),
    0 0 8px rgba(242,208,122,.3);
  z-index: 10;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.sp-card:hover .rivet {
  box-shadow: 
    0 5px 15px rgba(0,0,0,.9),
    inset 0 0 0 2px rgba(0,0,0,.7),
    0 0 15px rgba(242,208,122,.5);
}

.rivet-1 { top: 24px; left: 24px; }
.rivet-2 { top: 24px; right: 24px; }
.rivet-3 { bottom: 24px; left: 24px; }
.rivet-4 { bottom: 24px; right: 24px; }
.rivet-5 { top: 50%; left: 12px; transform: translateY(-50%); }
.rivet-6 { top: 50%; right: 12px; transform: translateY(-50%); }
.rivet-7 { left: 50%; top: 12px; transform: translateX(-50%); }
.rivet-8 { left: 50%; bottom: 12px; transform: translateX(-50%); }

/* ===== Ð”Ð•ÐšÐžÐ ÐÐ¢Ð˜Ð’ÐÐ† Ð›Ð†ÐÐ†Ð‡ ===== */
.decor-line {
  position: absolute;
  background: linear-gradient(90deg, transparent, rgba(242,208,122,.4), transparent);
  height: 2px;
  width: 70%;
  left: 15%;
  opacity: 0.6;
  z-index: 3;
}

.line-top { top: 45%; }
.line-bottom { bottom: 45%; }

/* ===== Ð‘Ð•Ð™Ð”Ð– Ð Ð†Ð”ÐšÐžÐ¡Ð¢Ð† ===== */
.rarity-badge {
  position: absolute;
  top: 24px;
  right: 24px;
  padding: 6px 14px;
  border-radius: 12px;
  background:
    linear-gradient(135deg, rgba(0,0,0,.95) 0%, rgba(0,0,0,.8) 100%);
  border: 2px solid var(--rar);
  color: var(--rar);
  font-size: 11px;
  font-weight: 900;
  letter-spacing: 1.5px;
  z-index: 5;
  text-transform: uppercase;
  box-shadow:
    0 5px 15px rgba(0,0,0,.8),
    inset 0 0 12px rgba(0,0,0,.6),
    0 0 15px color-mix(in srgb, var(--rar) 35%, transparent);
  transition: all 0.3s ease;
}

.sp-card:hover .rarity-badge {
  transform: translateY(-3px);
  box-shadow:
    0 8px 20px rgba(0,0,0,.9),
    inset 0 0 12px rgba(0,0,0,.6),
    0 0 25px color-mix(in srgb, var(--rar) 50%, transparent);
}

/* ===== Ð¨Ð•Ð¡Ð¢Ð•Ð ÐÐ¯ ===== */
.corner-gear {
  position: absolute;
  top: 22px;
  left: 22px;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  z-index: 5;
  
  background:
    conic-gradient(from 0deg,
      var(--brass2) 0deg 10deg,
      var(--brass1) 10deg 20deg,
      var(--brass2) 20deg 30deg,
      var(--brass1) 30deg 40deg,
      var(--brass2) 40deg 50deg,
      var(--brass1) 50deg 60deg,
      var(--brass2) 60deg 70deg,
      var(--brass1) 70deg 80deg,
      var(--brass2) 80deg 90deg,
      var(--brass1) 90deg 100deg,
      var(--brass2) 100deg 110deg,
      var(--brass1) 110deg 120deg,
      var(--brass2) 120deg 130deg,
      var(--brass1) 130deg 140deg,
      var(--brass2) 140deg 150deg,
      var(--brass1) 150deg 160deg,
      var(--brass2) 160deg 170deg,
      var(--brass1) 170deg 180deg,
      var(--brass2) 180deg 190deg,
      var(--brass1) 190deg 200deg,
      var(--brass2) 200deg 210deg,
      var(--brass1) 210deg 220deg,
      var(--brass2) 220deg 230deg,
      var(--brass1) 230deg 240deg,
      var(--brass2) 240deg 250deg,
      var(--brass1) 250deg 260deg,
      var(--brass2) 260deg 270deg,
      var(--brass1) 270deg 280deg,
      var(--brass2) 280deg 290deg,
      var(--brass1) 290deg 300deg,
      var(--brass2) 300deg 310deg,
      var(--brass1) 310deg 320deg,
      var(--brass2) 320deg 330deg,
      var(--brass1) 330deg 340deg,
      var(--brass2) 340deg 350deg,
      var(--brass1) 350deg 360deg
    );
  
  box-shadow:
    inset 0 0 0 3px rgba(0,0,0,.8),
    0 10px 25px rgba(0,0,0,.9),
    0 0 30px color-mix(in srgb, var(--elem) 60%, transparent),
    inset 0 0 15px rgba(0,0,0,.6);
  
  display: grid;
  place-items: center;
  transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.sp-card:hover .corner-gear {
  transform: rotate(720deg) scale(1.15);
  box-shadow:
    inset 0 0 0 3px rgba(0,0,0,.8),
    0 15px 35px rgba(0,0,0,.95),
    0 0 50px color-mix(in srgb, var(--elem) 80%, transparent),
    inset 0 0 20px rgba(0,0,0,.7);
}

/* Ð’Ð½ÑƒÑ‚Ñ€Ñ–ÑˆÐ½Ñ Ñ‡Ð°ÑÑ‚Ð¸Ð½Ð° ÑˆÐµÑÑ‚ÐµÑ€Ð½Ñ– Ñ–Ð· SVG */
.gear-inner {
  position: absolute;
  inset: 8px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 6;
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.3), rgba(255,255,255,.1) 40%, transparent 70%),
    radial-gradient(circle at 70% 70%, rgba(0,0,0,.8), transparent 40%),
    linear-gradient(180deg, #3a2c1a, #0a0604);
  box-shadow:
    inset 0 0 20px rgba(0,0,0,.95),
    inset 0 0 0 2px rgba(0,0,0,.8);
  border: 1px solid rgba(242,208,122,.2);
}

/* Ð¦ÐµÐ½Ñ‚Ñ€ ÑˆÐµÑÑ‚ÐµÑ€Ð½Ñ– */
.corner-gear::before {
  content: "";
  position: absolute;
  inset: 10px;
  border-radius: 50%;
  background:
    linear-gradient(180deg, #3a2c1a, #0a0604);
  box-shadow:
    inset 0 0 15px rgba(0,0,0,.95),
    inset 0 0 0 1px rgba(242,208,122,.15);
  z-index: 3;
}

/* Ð’Ð½ÑƒÑ‚Ñ€Ñ–ÑˆÐ½Ñ” ÐºÑ–Ð»ÑŒÑ†Ðµ */
.corner-gear::after {
  content: "";
  position: absolute;
  inset: 14px;
  border-radius: 50%;
  border: 1px solid rgba(242,208,122,.25);
  box-shadow:
    inset 0 0 10px rgba(0,0,0,.8);
  z-index: 3;
}

/* ===== SVG Ð—ÐÐÐ§ÐžÐš Ð¡Ð¢Ð˜Ð¥Ð†Ð‡ ===== */
.element-icon {
  width: 36px;
  height: 36px;
  position: relative;
  z-index: 7;
  transition: all 0.4s ease;
  filter:
    drop-shadow(0 0 12px color-mix(in srgb, var(--elem) 90%, transparent))
    drop-shadow(0 4px 10px rgba(0,0,0,.9));
  animation: element-float 3s ease-in-out infinite;
  color: var(--elem);
  display: flex;
  align-items: center;
  justify-content: center;
}

.sp-card:hover .element-icon {
  transform: scale(1.25) rotate(8deg);
  filter:
    drop-shadow(0 0 20px color-mix(in srgb, var(--elem) 100%, transparent))
    drop-shadow(0 6px 15px rgba(0,0,0,.95));
}

/* ===== Ð¡Ð¢ÐÐ¢Ð˜Ð¡Ð¢Ð˜ÐšÐ ===== */
.stats-plate {
  position: absolute;
  top: 100px;
  left: 16px;
  right: 16px;
  display: flex;
  justify-content: center;
  padding: 8px 12px;
  background:
    linear-gradient(135deg, #3d2f1f, #241a12);
  border: 1px solid color-mix(in srgb, var(--elem) 40%, #6b5837);
  border-radius: 10px;
  box-shadow:
    0 2px 6px rgba(0,0,0,.5),
    inset 0 1px 0 rgba(255,255,255,.1);
  z-index: 8;
}

.stat-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}

.stat-icon {
  font-size: 14px;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.6));
}

.stat-value {
  color: #f4e6c6;
  font-size: 13px;
  font-weight: 700;
  text-shadow:
    0 0 6px var(--elem),
    0 1px 2px rgba(0,0,0,0.8);
}

/* ===== ÐŸÐ›ÐÐ¨ÐšÐ Ð¡Ð˜Ð›Ð˜ ===== */
.power-plate {
  position: absolute;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  width: 80%;
  height: 70px;
  border-radius: 16px;
  
  background:
    radial-gradient(ellipse at top, rgba(255,210,120,.3) 0%, transparent 70%),
    linear-gradient(180deg, rgba(0,0,0,.5) 0%, rgba(0,0,0,.95) 100%),
    linear-gradient(180deg, color-mix(in srgb, var(--rar) 25%, #2a1c14), color-mix(in srgb, var(--rar) 20%, #0a0604));
  
  border: 2px solid rgba(242,208,122,.4);
  box-shadow:
    inset 0 0 25px rgba(0,0,0,.95),
    0 10px 30px rgba(0,0,0,.9),
    inset 0 0 0 2px rgba(0,0,0,.8),
    0 0 20px color-mix(in srgb, var(--elem) 30%, transparent);
  
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  overflow: hidden;
  z-index: 4;
}

.sp-card:hover .power-plate {
  transform: translateX(-50%) translateY(-8px);
  box-shadow:
    inset 0 0 25px rgba(0,0,0,.95),
    0 15px 40px rgba(0,0,0,.95),
    inset 0 0 0 2px rgba(0,0,0,.8),
    0 0 40px color-mix(in srgb, var(--elem) 50%, transparent);
  height: 75px;
  border-width: 3px;
}

/* Ð•Ñ„ÐµÐºÑ‚ ÑÐ²Ñ–Ñ‚Ñ–Ð½Ð½Ñ */
.power-plate::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.15), transparent);
  animation: shine 4s infinite ease-in-out;
  z-index: 2;
}

@keyframes shine {
  0% { left: -100%; }
  20%, 100% { left: 100%; }
}

/* Ð§Ð¸ÑÐ»Ð¾ ÑÐ¸Ð»Ð¸ */
.power-value {
  font-size: 36px;
  font-weight: 900;
  color: var(--brass0);
  font-variant-numeric: tabular-nums;
  text-shadow:
    0 3px 3px rgba(0,0,0,.95),
    0 0 40px rgba(255,210,120,.4),
    0 0 20px color-mix(in srgb, var(--elem) 40%, transparent),
    0 0 5px currentColor;
  position: relative;
  z-index: 2;
  transition: all 0.4s ease;
  letter-spacing: -1px;
}

.sp-card:hover .power-value {
  color: color-mix(in srgb, var(--rar) 60%, var(--brass0));
  text-shadow:
    0 3px 3px rgba(0,0,0,.95),
    0 0 60px rgba(255,210,120,.6),
    0 0 30px color-mix(in srgb, var(--elem) 60%, transparent),
    0 0 10px currentColor;
  font-size: 40px;
}

/* ===== Ð•Ð›Ð•ÐœÐ•ÐÐ¢Ð˜ ===== */
.sp-card.fire { --elem: var(--fire); }
.sp-card.water { --elem: var(--water); }
.sp-card.air { --elem: var(--air); }
.sp-card.earth { --elem: var(--earth); }

.sp-card.R1 { --rar: var(--common); --rar-border: #7f7f7f; }
.sp-card.R2 { --rar: #7aaa6f; --rar-border: #1e88e5; }
.sp-card.R3 { --rar: var(--rare); --rar-border: #2e7d32; }
.sp-card.R4 { --rar: var(--epic); --rar-border: #7b1fa2; }
.sp-card.R5 { --rar: var(--legend); --rar-border: #ffbf00; }
.sp-card.R6 { --rar: #c92a2a; --rar-border: #d50000; }

/* Custom rarity backgrounds: Legend (R5) = bright gold gradient, Epic/Mystic (R4) = red gradient */
.sp-card.R5 {
  background:
    radial-gradient(circle at 25% 25%, rgba(255,235,150,0.28) 0%, transparent 60%),
    radial-gradient(circle at 75% 75%, rgba(255,200,80,0.12) 0%, transparent 65%),
    linear-gradient(135deg, rgba(0,0,0,.25) 0%, rgba(0,0,0,.6) 50%, rgba(0,0,0,.8) 100%),
    linear-gradient(180deg, #fff7d1 0%, #ffd83a 35%, #ffbf00 60%, #8a5a00 100%);
  box-shadow:
    0 25px 50px var(--shadow),
    inset 0 0 30px rgba(0,0,0,.85),
    0 0 40px rgba(255,200,60,.18),
    0 0 0 1px rgba(255,230,140,.04);
}

.sp-card.R5::before {
  background:
    repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(255,235,150,.04) 2px, rgba(255,210,110,.04) 4px),
    linear-gradient(135deg, rgba(255,220,120,.95), rgba(200,120,40,.6), rgba(120,75,30,.35));
}

.sp-card.R5::after {
  background:
    repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(255,255,255,.02) 1px, rgba(255,255,255,.02) 2px),
    radial-gradient(ellipse at 50% 30%, rgba(255,245,180,.12) 0%, transparent 70%),
    linear-gradient(180deg, rgba(255,230,140,.08) 0%, rgba(0,0,0,.45) 100%),
    linear-gradient(180deg, #fff2c6, #5a3d12);
}

.sp-card.R4 {
  background:
    radial-gradient(circle at 25% 25%, rgba(195,160,255,0.16) 0%, transparent 60%),
    radial-gradient(circle at 75% 75%, rgba(140,80,200,0.12) 0%, transparent 65%),
    linear-gradient(135deg, rgba(0,0,0,.35) 0%, rgba(0,0,0,.7) 50%, rgba(0,0,0,.9) 100%),
    linear-gradient(180deg, #f3e8ff 0%, #c9a6ff 35%, #8a5ccf 100%);
  box-shadow:
    0 25px 50px var(--shadow),
    inset 0 0 30px rgba(0,0,0,.85),
    0 0 30px rgba(150,100,255,.11),
    0 0 0 1px rgba(200,160,255,.03);
}

.sp-card.R4::before {
  background:
    repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(220,200,255,.03) 2px, rgba(170,120,230,.03) 4px),
    linear-gradient(135deg, rgba(170,120,230,.95), rgba(120,60,180,.5), rgba(60,20,100,.25));
}

.sp-card.R4::after {
  background:
    repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(255,255,255,.02) 1px, rgba(255,255,255,.02) 2px),
    radial-gradient(ellipse at 50% 30%, rgba(240,210,255,.10) 0%, transparent 70%),
    linear-gradient(180deg, rgba(255,230,255,.06) 0%, rgba(0,0,0,.5) 100%),
    linear-gradient(180deg, #d9bfff, #3a0f4a);
}

/* R6: red rarity (distinct from epic R4) */
.sp-card.R6 {
  background:
    radial-gradient(circle at 25% 25%, rgba(255,160,160,0.18) 0%, transparent 60%),
    radial-gradient(circle at 75% 75%, rgba(200,60,60,0.12) 0%, transparent 65%),
    linear-gradient(135deg, rgba(0,0,0,.35) 0%, rgba(0,0,0,.7) 50%, rgba(0,0,0,.9) 100%),
    linear-gradient(180deg, #ffe5e5 0%, #ff8a8a 30%, #e03030 70%, #7a0f0f 100%);
  box-shadow:
    0 25px 50px var(--shadow),
    inset 0 0 30px rgba(0,0,0,.85),
    0 0 30px rgba(255,80,80,.14),
    0 0 0 1px rgba(255,160,160,.03);
}

.sp-card.R6::before {
  background:
    repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(255,180,180,.03) 2px, rgba(200,80,80,.03) 4px),
    linear-gradient(135deg, rgba(220,100,100,.9), rgba(160,60,60,.5), rgba(90,30,30,.25));
}

.sp-card.R6::after {
  background:
    repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(255,255,255,.02) 1px, rgba(255,255,255,.02) 2px),
    radial-gradient(ellipse at 50% 30%, rgba(255,200,200,.10) 0%, transparent 70%),
    linear-gradient(180deg, rgba(255,200,200,.06) 0%, rgba(0,0,0,.5) 100%),
    linear-gradient(180deg, #ffb6b6, #4a0a0a);
}

/* ===== ÐÐÐ†ÐœÐÐ¦Ð†Ð‡ ===== */
@media (prefers-reduced-motion: no-preference) {
  .sp-card {
    animation: card-float 6s ease-in-out infinite;
  }
  
  .element-icon {
    animation: element-float 3s ease-in-out infinite;
  }
  
  @keyframes card-float {
    0%, 100% {
      transform: translateY(0px);
      filter: brightness(1) contrast(1.05);
    }
    50% {
      transform: translateY(-5px);
      filter: brightness(1.1) contrast(1.1);
    }
  }
  
  @keyframes element-float {
    0%, 100% {
      transform: scale(1);
      filter: drop-shadow(0 0 15px color-mix(in srgb, var(--elem) 70%, transparent));
    }
    50% {
      transform: scale(1.1);
      filter: drop-shadow(0 0 20px color-mix(in srgb, var(--elem) 90%, transparent));
    }
  }
}

.sp-card:active {
  transform: scale(0.95);
  transition: transform 0.1s ease;
}

/* ===== PATCH: RARITY COLORS R1-R6 (override) ===== */
:root{
  --r1: #9e9e9e;  /* grey */
  --r2: #4aa0d6;  /* blue */
  --r3: #4caf50;  /* green */
  --r4: #8a5ccf;  /* purple */
  --r5: #ffd83a;  /* gold */
  --r6: #c92a2a;  /* red  */
}

/* Map rarity -> variables used by frame + glow */
.sp-card.R1 { --rar: var(--r1); --rar-border: var(--r1); }
.sp-card.R2 { --rar: var(--r2); --rar-border: var(--r2); }
.sp-card.R3 { --rar: var(--r3); --rar-border: var(--r3); }
.sp-card.R4 { --rar: var(--r4); --rar-border: var(--r4); }
.sp-card.R5 { --rar: var(--r5); --rar-border: var(--r5); }
.sp-card.R6 { --rar: var(--r6); --rar-border: var(--r6); }

/* Stronger, more saturated frame without changing whole card */
.sp-card::before{
  /* saturation/contrast only on the metal frame layer */
  filter: saturate(1.35) contrast(1.10);
  box-shadow:
    inset 0 0 0 3px color-mix(in srgb, var(--rar-border) 75%, rgba(0,0,0,.75)),
    inset 0 0 30px rgba(0,0,0,.70),
    0 0 24px color-mix(in srgb, var(--rar) 45%, transparent);
}

.sp-card:hover::before{
  filter: saturate(1.75) contrast(1.15);
  box-shadow:
    inset 0 0 0 3px color-mix(in srgb, var(--rar-border) 85%, rgba(0,0,0,.70)),
    inset 0 0 32px rgba(0,0,0,.70),
    0 0 34px color-mix(in srgb, var(--rar) 55%, transparent);
}

/* Optional: keep power plate border aligned with rarity (subtle) */
.power-plate{
  border-color: color-mix(in srgb, var(--rar) 55%, rgba(242,208,122,.25));
}

/* PATCH: map mythic -> R6 (red) */
.sp-card.mythic,
.sp-card.rarity-mythic,
.sp-card[data-rarity="mythic"]{
  --rar: #c92a2a;
  --rar-border: #c92a2a;
}

/* map preview/details elements if used outside .sp-card */
.card-preview.mythic,
.card-preview[data-rarity="mythic"],
.card-details.mythic,
.card-details[data-rarity="mythic"]{
  --rar: #c92a2a;
  --rar-border: #c92a2a;
}

/* =========================================================
   PATCH: HARD RARITY â†’ CLASS BINDING (FINAL OVERRIDE)
   ========================================================= */

/* 1. Remove unsafe default rarity (gold by default) */
.sp-card{
  --rar: #9e9e9e;        /* fallback = R1 */
  --rar-border: #9e9e9e;
}

/* 2. Canonical rarity colors */
:root{
  --rar-R1: #9e9e9e;   /* common / grey   */
  --rar-R2: #4aa0d6;   /* blue            */
  --rar-R3: #4caf50;   /* green           */
  --rar-R4: #8a5ccf;   /* purple          */
  --rar-R5: #ffd83a;   /* gold            */
  --rar-R6: #c92a2a;   /* red / mythic    */
}

/* 3. Direct R-class binding */
.sp-card.R1{ --rar: var(--rar-R1); --rar-border: var(--rar-R1); }
.sp-card.R2{ --rar: var(--rar-R2); --rar-border: var(--rar-R2); }
.sp-card.R3{ --rar: var(--rar-R3); --rar-border: var(--rar-R3); }
.sp-card.R4{ --rar: var(--rar-R4); --rar-border: var(--rar-R4); }
.sp-card.R5{ --rar: var(--rar-R5); --rar-border: var(--rar-R5); }
.sp-card.R6{ --rar: var(--rar-R6); --rar-border: var(--rar-R6); }

/* ==============================
   RARE (rare) â€” Ð—Ð•Ð›Ð•ÐÐ Ð ÐÐœÐšÐ
   ÐŸÑ€Ð°Ñ†ÑŽÑ” Ð´Ð»Ñ ÐºÐ»Ð°ÑÑƒ .rare Ñ– Ð´Ð»Ñ data-rarity="rare"
   ============================== */
.sp-card.rare,
.sp-card[data-rarity="rare"]{
  --rar: #3fbf6f;        /* Ð¿Ñ–Ð´ÑÐ²Ñ–Ñ‚ÐºÐ°/Ð°ÐºÑ†ÐµÐ½Ñ‚Ð¸ */
  --rar-border: #2e7d32; /* ÑÐ°Ð¼Ðµ Ñ€Ð°Ð¼ÐºÐ° */
}

/* 4. Text / semantic aliases â†’ hard map */
.sp-card.common,
.sp-card[data-rarity="common"]{
  --rar: var(--rar-R1); --rar-border: var(--rar-R1);
}

.sp-card.uncommon,
.sp-card[data-rarity="uncommon"]{
  --rar: var(--rar-R2); --rar-border: var(--rar-R2);
}

.sp-card.rare,
.sp-card[data-rarity="rare"]{
  --rar: var(--rar-R3); --rar-border: var(--rar-R3);
}

.sp-card.epic,
.sp-card[data-rarity="epic"]{
  --rar: var(--rar-R4); --rar-border: var(--rar-R4);
}

.sp-card.legendary,
.sp-card[data-rarity="legendary"]{
  --rar: var(--rar-R5); --rar-border: var(--rar-R5);
}

.sp-card.mythic,
.sp-card[data-rarity="mythic"]{
  --rar: var(--rar-R6); --rar-border: var(--rar-R6);
}

/* 5. Safety: if multiple rarity classes are present, R6 > R5 > ... > R1 */
.sp-card.R6,
.sp-card.mythic{ --rar: var(--rar-R6); --rar-border: var(--rar-R6); }

.sp-card.R5,
.sp-card.legendary{ --rar: var(--rar-R5); --rar-border: var(--rar-R5); }

.sp-card.R4,
.sp-card.epic{ --rar: var(--rar-R4); --rar-border: var(--rar-R4); }

.sp-card.R3,
.sp-card.rare{ --rar: var(--rar-R3); --rar-border: var(--rar-R3); }

.sp-card.R2,
.sp-card.uncommon{ --rar: var(--rar-R2); --rar-border: var(--rar-R2); }

.sp-card.R1,
.sp-card.common{ --rar: var(--rar-R1); --rar-border: var(--rar-R1); }

/* 6. Frame saturation tied to rarity (visual guarantee) */
.sp-card::before{
  filter: saturate(1.4) contrast(1.1);
  box-shadow:
    inset 0 0 0 3px color-mix(in srgb, var(--rar-border) 80%, rgba(0,0,0,.8)),
    inset 0 0 30px rgba(0,0,0,.75),
    0 0 26px color-mix(in srgb, var(--rar) 45%, transparent);
}

.sp-card:hover::before{
  filter: saturate(1.8) contrast(1.2);
  box-shadow:
    inset 0 0 0 3px color-mix(in srgb, var(--rar-border) 90%, rgba(0,0,0,.75)),
    inset 0 0 35px rgba(0,0,0,.8),
    0 0 38px color-mix(in srgb, var(--rar) 60%, transparent);
}



/* Combined CSS: styles.css */
/* ðŸ”´ FORCE DISABLE DECK BUTTONS (GLOBAL) */
.card-actions,
.card-actions *,
.btn-add,
.btn-remove,
button[data-action="add"],
button[data-action="remove"],
button.add-to-deck,
button.remove-from-deck {
  display: none !important;
  visibility: hidden !important;
  pointer-events: none !important;
}

/* Also target known IDs used in card details */
#card-add-to-deck-btn,
#card-remove-btn,
#card-upgrade-btn {
  display: none !important;
  visibility: hidden !important;
  pointer-events: none !important;
}

/* Unified Card UI Kit variables and classes */
:root{
  --card-w: 124px; /* reference width for deck */
  --card-h: 160px;
  --card-radius: 16px;
  --card-gap: 10px;
}

/* Grid used both in deck and duel screens */
.cards-grid{
  display: grid;
  grid-template-columns: repeat(3, var(--card-w));
  gap: var(--card-gap);
  justify-content: center;
  align-content: start;
  grid-auto-rows: var(--card-h);
}

/* Base card style â€” prevents stretching */
.card{
  width: var(--card-w);
  height: var(--card-h);
  border-radius: var(--card-radius);
  flex: 0 0 auto;
  box-sizing: border-box;
}

/* Ensure variant classes inherit the base card sizing and remove transforms */
.battle-card,
.duel-card,
.hand-card,
.deck-card{
  width: var(--card-w) !important;
  height: var(--card-h) !important;
  flex: 0 0 auto !important;
  transform: none !important;
}

/* Prevent common container rules from stretching cards (override worst offenders) */
.battle-hand > *,
.cards-grid > *{
  flex: 0 0 auto !important;
}

/* Screen section wrapper to align duel and deck screens */
.screen-section{
  max-width: calc(var(--card-w)*3 + var(--card-gap)*2);
  margin: 0 auto;
  padding: 8px;
}

/* =========================================================
   SINGLE SOURCE OF TRUTH â€” CARD SIZE (GLOBAL PATCH)
   ========================================================= */

/* 1) Ð„Ð´Ð¸Ð½Ñ– Ð·Ð¼Ñ–Ð½Ð½Ñ– Ñ€Ð¾Ð·Ð¼Ñ–Ñ€Ñƒ */
:root{
  --card-width: 128px;   /* ÐœÐ†ÐÐ¯Ð™ Ð¢Ð†Ð›Ð¬ÐšÐ˜ Ð¦Ð• */
  --card-height: 170px;  /* Ð† Ð¦Ð• */
  --card-radius: 16px;
}

/* 2) Ð£Ð¡Ð† Ð¼Ð¾Ð¶Ð»Ð¸Ð²Ñ– ÐºÐ»Ð°ÑÐ¸ ÐºÐ°Ñ€Ñ‚ Ñƒ Ð¿Ñ€Ð¾Ñ”ÐºÑ‚Ñ– */
.card,
.deck-card,
.battle-card,
.duel-card,
.hand-card,
.sp-card {
  width: var(--card-width) !important;
  min-width: var(--card-width) !important;
  max-width: var(--card-width) !important;

  height: var(--card-height) !important;
  min-height: var(--card-height) !important;
  max-height: var(--card-height) !important;

  border-radius: var(--card-radius) !important;

  flex: 0 0 auto !important;
  box-sizing: border-box !important;

  transform: none !important;
  scale: 1 !important;
}

/* 3) Ð¯ÐºÑ‰Ð¾ Ñ€Ð¾Ð·Ð¼Ñ–Ñ€Ð¸ Ð·Ð°Ð´Ð°Ð²Ð°Ð»Ð¸ÑÑŒ inline-ÑÑ‚Ð¸Ð»ÑÐ¼Ð¸ â€” Ð¿Ñ€Ð¸Ð±Ð¸Ð²Ð°Ñ”Ð¼Ð¾ */
.card[style],
.deck-card[style],
.battle-card[style],
.duel-card[style],
.hand-card[style],
.sp-card[style] {
  width: var(--card-width) !important;
  height: var(--card-height) !important;
}

/* 4) ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸ ÐºÐ°Ñ€Ñ‚ â€” Ð—ÐÐ‘ÐžÐ ÐžÐÐ˜Ð¢Ð˜ Ñ€Ð¾Ð·Ñ‚ÑÐ³ÑƒÐ²Ð°Ð½Ð½Ñ */
.cards-grid,
.deck-grid,
.duel-grid,
.battle-hand,
.hand,
.deck {
  display: grid !important;
  grid-template-columns: repeat(3, var(--card-width)) !important;
  grid-auto-rows: var(--card-height) !important;
  gap: 10px !important;
  justify-content: center !important;
  align-content: start !important;
}

/* 5) Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²ÐºÐ° Ð²Ñ–Ð´ flex-ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ñ–Ð² */
.cards-grid > *,
.deck-grid > *,
.duel-grid > *,
.battle-hand > *,
.hand > *,
.deck > * {
  flex: 0 0 auto !important;
}

/* =====================================================
   ICON SIZE PATCH â€” shrink all card icons
   ===================================================== */

/* ÐžÑÐ½Ð¾Ð²Ð½Ð° Ñ–ÐºÐ¾Ð½ÐºÐ° ÑÑ‚Ð¸Ñ…Ñ–Ñ— Ð½Ð° ÐºÐ°Ñ€Ñ‚Ñ– */
.sp-card img,
.sp-card .icon,
.sp-card .element-icon,
.sp-card .card-icon {
  width: 8px !important;     /* Ð·Ð¼ÐµÐ½ÑˆÐµÐ½Ð¾ Ñƒ 2 Ñ€Ð°Ð·Ð¸ */
  height: 8px !important;
  max-width: 8px !important;
  max-height: 8px !important;

  transform: none !important;
}

/* Ð¯ÐºÑ‰Ð¾ Ñ–ÐºÐ¾Ð½ÐºÐ° Ð² ÐºÐ¾Ð»Ñ– (Ñ€Ð°Ð¼ÐºÐ° Ð½Ð°Ð²ÐºÐ¾Ð»Ð¾) */
.sp-card .icon-wrap,
.sp-card .icon-circle {
  width: 24px !important;     /* â¬… Ñ‚Ñ€Ð¾Ñ…Ð¸ Ð±Ñ–Ð»ÑŒÑˆÐµ Ð·Ð° Ñ–ÐºÐ¾Ð½ÐºÑƒ */
  height: 24px !important;
}

/* ==========================
   HUD XP BAR (STEAMPUNK)
   ========================== */

.hud-xp{
  display:flex;
  flex-direction:column;
  gap:6px;
  min-width: 150px;
}

.hud-xp-top{
  display:flex;
  justify-content:space-between;
  align-items:baseline;
  font-size: 13px;
  line-height: 1;
  color: #e7d8a6;
  text-shadow: 0 1px 0 rgba(0,0,0,.55);
}

.hud-xp-text{
  opacity: .85;
  font-size: 12px;
}

/* ÑÐ°Ð¼Ð° "Ñ‚Ñ€ÑƒÐ±Ð°" ÑˆÐºÐ°Ð»Ð¸ */
.hud-xp-bar{
  height: 10px;
  border-radius: 999px;
  overflow: hidden;
  background: rgba(255,255,255,0.06);
  box-shadow:
    inset 0 0 0 1px rgba(255,215,120,0.14),
    inset 0 2px 8px rgba(0,0,0,0.55);
}

/* Ð·Ð°Ð¿Ð¾Ð²Ð½ÐµÐ½Ð½Ñ */
.hud-xp-fill{
  height: 100%;
  width: 0%;
  border-radius: inherit;
  transition: width .25s ease;
  background: linear-gradient(90deg,
    rgba(90,210,255,.9),
    rgba(120,255,220,.9)
  );
}

/* ÑÐºÑ‰Ð¾ Ð·Ð»Ñ–Ð²Ð° Ñƒ HUD Ð¼Ð°Ð»Ð¾ Ð¼Ñ–ÑÑ†Ñ â€” Ñ‚Ñ€Ð¸Ð¼Ð°Ð¹ Ð²ÑÐµ ÐºÐ¾Ð¼Ð¿Ð°ÐºÑ‚Ð½Ð¾ */
@media (max-width: 450px){
  .hud-xp{ min-width: 130px; }
  .hud-xp-top{ font-size: 12px; }
  .hud-xp-bar{ height: 9px; }
}

/* Hide legacy HUD XP selectors to avoid duplicate displays */
.hud-xp-row,
.hud-xp-row__fill,
.hud-xp-row__label,
.hud-xpline,
.hud-xpfill { display: none !important; }

/* === HUD XP BAR === */
.xp-hud {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 120px;
}

.xp-bar {
  height: 10px;
  border-radius: 999px;
  background: linear-gradient(180deg, #0b0907, #050403);
  border: 1px solid rgba(242,208,122,0.25);
  box-shadow: inset 0 0 10px rgba(0,0,0,0.85);
  overflow: hidden;
}

.xp-bar .xp-fill {
  display: block;
  height: 100%;
  width: 0%;
  background: linear-gradient(
    90deg,
    #7a5520,
    #c59b3c 40%,
    #f2d07a 75%,
    #fff2c0
  );
  box-shadow: 0 0 12px rgba(242,208,122,0.45);
  transition: width 0.3s ease;
}

.xp-text {
  font-size: 11px;
  color: var(--muted);
  text-align: center;
  font-variant-numeric: tabular-nums;
}

/* XP Ð¿Ñ–Ð´ Ð²Ð°Ð»ÑŽÑ‚Ð¾ÑŽ Ð½Ð° Ð²ÑÑŽ ÑˆÐ¸Ñ€Ð¸Ð½Ñƒ Ñ‚Ð¾Ð¿Ð±Ð°Ñ€Ñƒ */
.topbar{
  display: flex;
  flex-direction: column;
}

.hud-xp-under-currency{
  width: 100%;
  align-self: stretch;
  padding: 0 12px 10px;
  margin-top: 6px;
}

/* Ð¿Ñ€Ð¸Ð±Ð¸Ñ€Ð°Ñ”Ð¼Ð¾ "Ð¼Ñ–Ð½Ñ–Ð¼Ð°Ð»ÑŒÐ½Ñƒ ÑˆÐ¸Ñ€Ð¸Ð½Ñƒ", ÑÐºÐ° ÑÑ‚Ð¸ÑÐºÐ°Ñ” Ð±Ð°Ñ€ */
.hud-xp{
  min-width: 0 !important;
}

/* Ð±Ð°Ñ€ Ð·Ð°Ð²Ð¶Ð´Ð¸ Ð½Ð° 100% */
.hud-xp-bar{
  width: 100%;
}

/* Ð¢ÐµÐºÑÑ‚ Ð¼Ð¾Ð¶Ð½Ð° Ð²Ð¸Ñ€Ñ–Ð²Ð½ÑÑ‚Ð¸ Ð³Ð°Ñ€Ð½Ð¾ Ð¿Ð¾ ÐºÑ€Ð°ÑÑ… */
.hud-xp-top{
  width: 100%;
}

/* ÐÐµ Ñ‡Ñ–Ð¿Ð°Ñ”Ð¼Ð¾ Ñ€Ð°Ð¼ÐºÑƒ: Ð´Ð¾Ð´Ð°Ñ”Ð¼Ð¾ Ñ‚Ñ–Ð»ÑŒÐºÐ¸ override Ð´Ð»Ñ svg Ñƒ ÐºÑƒÑ‚Ð¾Ð²Ñ–Ð¹ ÑˆÐµÑÑ‚ÐµÑ€Ð½Ñ– Ñ– Ð´Ð»Ñ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ ÑÐ¸Ð»Ð¸ */
.sp-card .corner-gear svg {
  width: 11px !important;
  height: 11px !important;
}

/* Ð—Ð¼ÐµÐ½ÑˆÐ¸Ñ‚Ð¸ Ñ€Ð¾Ð·Ð¼Ñ–Ñ€ ÑˆÑ€Ð¸Ñ„Ñ‚Ñƒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ ÑÐ¸Ð»Ð¸ Ñƒ ÐºÐ°Ñ€Ñ‚Ñ†Ñ– Ð²Ð´Ð²Ñ–Ñ‡Ñ– */
.sp-card .power-value {
  font-size: 16px !important;
}


/* Combined CSS: inline styles from original index.html */

    /* ÐšÐ¾Ð»Ð»ÐµÐºÑ†Ñ–Ñ: Ð³Ñ€Ð¸Ð´ ÐºÐ°Ñ€Ñ‚ */
    .collection-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr) !important;
      gap: 10px;
      margin-top: 10px;
    }
    .collection-card-item {
      background: rgba(50,30,20,0.4);
      border: 1.5px solid rgba(242,208,122,0.15);
      border-radius: 8px;
      padding: 10px 6px;
      text-align: center;
      transition: all 0.2s;
      min-height: 60px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .collection-card-item.found {
      background: linear-gradient(180deg, rgba(242,208,122,0.12), rgba(0,0,0,0.18));
      border-color: #8bc34a;
      color: var(--brass-0);
    }
    .collection-card-item.not-found {
      background: linear-gradient(180deg, #222 60%, #111 100%);
      border-color: #444;
      color: #888;
      opacity: 0.6;
    }
    .collection-card-name {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .collection-card-status {
      font-size: 11px;
      color: #8bc34a;
    }
    .collection-card-item.not-found .collection-card-status {
      color: #aaa;
    }
    /* Ð¡ÐµÑ‚ÐºÐ° ÑÐ»Ð°Ð±ÑˆÐ¸Ñ… ÐºÐ°Ñ€Ñ‚ â€” Ð¿Ð¾ 3 Ð² Ñ€ÑÐ´ */
    .weaker-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 12px;
    }
    .weaker-card-tile {
      background: rgba(30,20,18,0.45);
      border: 1px solid rgba(200,170,120,0.08);
      padding: 8px;
      border-radius: 8px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }
    .weaker-card-footer { display:flex; justify-content:space-between; align-items:center; gap:6px; margin-top:8px; }
    .weaker-card-pct { color: #c6ffb3; font-weight:700; }
    .weaker-add-btn { background:#c85; border:none; color:#111; padding:6px 8px; border-radius:6px; cursor:pointer }
    :root{
      --bg-0:#080605;
      --bg-1:#120d0a;
      --wood:#1a120c;

      --brass-0:#f2d07a;
      --brass-1:#c59b3c;
      --brass-2:#7a5520;

      --copper-0:#d8905b;
      --copper-1:#b56a33;
      --copper-2:#6f3316;

      --steel-0:#2a2f33;
      --steel-1:#14181b;

      --ink:#f4e6c6;
      --muted:#d0bf9a;

      --glow: rgba(255, 210, 110, 0.22);
      --shadow: rgba(0,0,0,0.65);

      --radius: 14px;

      /* Ð¡Ñ‚Ð¸Ñ…Ñ–Ñ— */
      --fire:#c45a2a;
      --water:#3b6c8e;
      --air:#9fb6c1;
      --earth:#7a6a3a;
      --steam:#8a7f8a;
      --mech:#5a5a5a;
      
      /* Ð Ñ–Ð´ÐºÐ¾ÑÑ‚Ñ– */
      --common:#b8a27b;
      --rare:#6fb2ff;
      --epic:#b07cff;
      --legend:#ffcc66;
      --tile-radius: 18px;
    }

    /* Base */
    *{ box-sizing: border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--ink);
      font-family: Georgia, "Times New Roman", serif;
      background:
        radial-gradient(1200px 800px at 50% -10%, rgba(255,200,120,0.10), transparent 55%),
        radial-gradient(900px 700px at 20% 25%, rgba(212,140,75,0.10), transparent 50%),
        radial-gradient(1000px 900px at 80% 60%, rgba(120,70,40,0.10), transparent 55%),
        linear-gradient(180deg, var(--bg-1), var(--bg-0));
      min-height: 100vh;
      display:block;
    }

    /* Phone frame */
    .phone{
      width:100vw;
      min-height:100vh;
      padding: 0;
      position: relative;
      background: transparent;
      overflow:hidden;
      display: flex;
      flex-direction: column;
    }

    /* Side copper rails */
    .phone::before,
    .phone::after{
      content:"";
      position:absolute;
      top:-30px; bottom:-30px;
      width: 18px;
      background:
        linear-gradient(180deg, rgba(255,220,140,0.10), transparent 12%),
        linear-gradient(180deg, #3b2010, #7a3b1a 35%, #a55a2b 50%, #6a2d12 70%, #2b140a);
      box-shadow: inset 0 0 0 1px rgba(255,210,120,0.25), 0 0 18px rgba(0,0,0,0.5);
      filter: saturate(1.1);
      opacity:0.95;
      border-radius: 12px;
    }
    .phone::before{ left:-6px; }
    .phone::after { right:-6px; }

    /* Subtle noise overlay */
    .noise{
      pointer-events:none;
      position:absolute; inset:0;
      opacity:0.10;
      background-image:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,0.08) 0 1px, transparent 2px),
        radial-gradient(circle at 70% 60%, rgba(255,255,255,0.07) 0 1px, transparent 2px),
        radial-gradient(circle at 40% 80%, rgba(255,255,255,0.06) 0 1px, transparent 2px);
      background-size: 60px 60px, 80px 80px, 100px 100px;
      mix-blend-mode: overlay;
    }

    /* Top bar */
    .topbar{
      position: relative;
      padding: 10px 10px 12px;
      border-radius: var(--radius);
      background:
        linear-gradient(180deg, rgba(255,210,110,0.08), rgba(0,0,0,0.35)),
        linear-gradient(180deg, #1b120c, #0c0907);
      box-shadow: 0 10px 24px var(--shadow);
      border: 1px solid rgba(245,210,120,0.20);
    }
    .topbar::before{
      content:"";
      position:absolute; inset:-1px;
      border-radius: var(--radius);
      background: linear-gradient(135deg, rgba(242,208,122,0.35), rgba(213,143,85,0.18), rgba(90,50,20,0.10));
      mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      padding: 1px;
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events:none;
    }

    .toprow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }

    .avatar{
      display:flex; align-items:center; gap:10px;
      min-width: 0;
    }

    .portrait{
      width:36px; height:36px;
      border-radius: 10px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,230,170,0.18), transparent 55%),
        linear-gradient(180deg, #2f1f14, #120c08);
      border: 1px solid rgba(242,208,122,0.35);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.6), 0 6px 12px rgba(0,0,0,0.55);
      position: relative;
    }
    .portrait::after{
      content:"";
      position:absolute; inset:4px;
      border-radius: 8px;
      background:
        radial-gradient(circle at 45% 35%, rgba(255,210,120,0.18), transparent 55%),
        radial-gradient(circle at 55% 65%, rgba(212,140,75,0.12), transparent 55%);
      opacity:0.8;
    }

    .level{
      font-variant-numeric: tabular-nums;
      color: var(--brass-0);
      font-weight:700;
      letter-spacing:0.02em;
      white-space:nowrap;
    }

    .meters{
      display:flex;
      align-items:center;
      gap:10px;
      font-variant-numeric: tabular-nums;
      white-space:nowrap;
    }

    .meter{
      display:flex;
      align-items:center;
      gap:6px;
      padding: 6px 10px;
      border-radius: 999px;
      background:
        linear-gradient(180deg, rgba(255,220,140,0.10), rgba(0,0,0,0.35)),
        linear-gradient(180deg, #1a120c, #0c0907);
      border: 1px solid rgba(242,208,122,0.22);
      box-shadow: inset 0 0 12px rgba(0,0,0,0.6);
    }
    .gem, .coin{
      width:10px; height:10px;
      border-radius: 2px;
      box-shadow: 0 0 10px var(--glow);
    }
    .gem{
      background: linear-gradient(135deg, #bfe8ff, #4aa0d6);
      border: 1px solid rgba(200,245,255,0.35);
    }
    .coin{
      background: linear-gradient(135deg, var(--brass-0), var(--brass-1));
      border: 1px solid rgba(255,230,140,0.35);
      border-radius: 50%;
    }

    .statusbar{
      margin-top: 10px;
      height: 10px;
      border-radius: 999px;
      background: linear-gradient(180deg, #0b0907, #050403);
      border: 1px solid rgba(242,208,122,0.18);
      box-shadow: inset 0 0 10px rgba(0,0,0,0.85);
      overflow:hidden;
      position:relative;
    }
    .statusbar > span{
      display:block; height:100%;
      width: 78%;
      background:
        linear-gradient(90deg, rgba(255,220,140,0.10), rgba(255,210,120,0.25)),
        linear-gradient(90deg, #4f2a12, #b56a33 40%, #f2d07a 75%, #c59b3c);
      box-shadow: 0 0 14px rgba(255,210,120,0.25);
    }

    /* Tiles grid */
    .tiles{
      margin-top: 10px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
    }

    .tile{
      position:relative;
      border-radius: var(--tile-radius);
      padding: 10px 10px 12px;
      min-height: 96px;
      background:
        radial-gradient(140px 120px at 30% 25%, rgba(255,220,140,0.16), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.22);
      box-shadow: 0 10px 20px rgba(0,0,0,0.55), inset 0 0 18px rgba(0,0,0,0.75);
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, filter .08s ease;
    }
    .tile:hover{ filter: brightness(1.05); }
    .tile:active{ transform: translateY(1px); }

    /* Ornate brass frame */
    .phone::before,
    .phone::after{
      content: none;
      display: none;
    }

    .tile .label{
      font-size: 13px;
      color: var(--brass-0);
      text-shadow: 0 1px 0 rgba(0,0,0,0.7);
    }
    .tile .sub{
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted);
      opacity:0.95;
    }

    .tile .icon{
      width:34px; height:34px;
      border-radius: 12px;
      margin-bottom: 8px;
      background:
        radial-gradient(circle at 35% 35%, rgba(255,230,170,0.18), transparent 60%),
        linear-gradient(180deg, #2f1f14, #120c08);
      border: 1px solid rgba(242,208,122,0.25);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.6);
      position: relative;
      overflow:hidden;
    }
    .tile .icon::after{
      content:"";
      position:absolute; inset:-40%;
      background:
        repeating-conic-gradient(from 0deg,
          rgba(242,208,122,0.12) 0 10deg,
          rgba(0,0,0,0.0) 10deg 20deg);
      opacity:0.55;
      transform: rotate(10deg);
    }

    /* Page system */
    #main-content{
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }
    .page{
      display:none;
      animation: fadeIn 0.3s ease;
      flex-direction: column;
      flex: 1;
      min-height: 0;
    }
    .page.active{
      display:flex;
    }
    @keyframes fadeIn{
      from{ opacity:0; transform: translateY(10px); }
      to{ opacity:1; transform: translateY(0); }
    }

    /* Page headers */
    .page-header{
      padding: 12px;
      background:
        linear-gradient(180deg, rgba(255,220,140,0.08), rgba(0,0,0,0.45)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border-bottom: 1px solid rgba(242,208,122,0.18);
      box-shadow: 0 4px 12px rgba(0,0,0,0.55);
      position: relative;
      display: flex;
      align-items: center;
      gap: 10px;
      flex-shrink: 0;
    }
    .page-title{
      font-size: 18px;
      color: var(--brass-0);
      text-shadow: 0 1px 2px rgba(0,0,0,0.7);
      margin: 0;
      flex: 1;
      text-align: center;
    }
    .back-btn{
      all: unset;
      padding: 8px 12px;
      font-size: 14px;
      color: var(--brass-1);
      cursor: pointer;
      border-radius: 8px;
      background: rgba(242,208,122,0.08);
      border: 1px solid rgba(242,208,122,0.15);
      transition: all 0.15s ease;
    }
    .back-btn:hover{
      background: rgba(242,208,122,0.15);
    }

    /* Page content */
    .page-content{
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      min-height: 0;
    }

    /* Info cards */
    .info-card{
      background:
        radial-gradient(140px 120px at 30% 25%, rgba(255,220,140,0.16), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.22);
      box-shadow: 0 6px 12px rgba(0,0,0,0.55), inset 0 0 18px rgba(0,0,0,0.75);
      border-radius: var(--radius);
      padding: 15px;
      margin-bottom: 12px;
      text-align: center;
    }
    .info-label{
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 8px;
    }
    .info-value{
      font-size: 24px;
      color: var(--brass-0);
      text-shadow: 0 1px 2px rgba(0,0,0,0.7);
      font-weight: 500;
    }

    /* Action buttons */
    .action-btn{
      all: unset;
      display: block;
      width: 100%;
      padding: 14px;
      margin: 12px 0;
      text-align: center;
      font-size: 15px;
      color: var(--bg-dark);
      background: linear-gradient(180deg, var(--brass-0), var(--brass-1));
      border-radius: var(--radius);
      border: 1px solid rgba(242,208,122,0.35);
      box-shadow: 0 8px 16px rgba(0,0,0,0.55), inset 0 0 0 1px rgba(255,255,255,0.15);
      cursor: pointer;
      transition: all 0.15s ease;
      font-weight: 500;
    }
    .action-btn:hover{
      filter: brightness(1.08);
      transform: translateY(-1px);
    }
    .action-btn:active{
      transform: translateY(0);
    }
    .action-btn.secondary{
      background: linear-gradient(180deg, rgba(242,208,122,0.25), rgba(197,155,60,0.15));
      color: var(--brass-0);
    }

    /* Description */
    .description{
      font-size: 13px;
      color: var(--muted);
      line-height: 1.5;
      margin-top: 15px;
      padding: 12px;
      background: rgba(0,0,0,0.35);
      border-radius: var(--radius);
      border: 1px solid rgba(242,208,122,0.12);
    }

    /* Tasks */
    .task-item{
      background:
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.55)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.18);
      border-radius: var(--radius);
      padding: 12px;
      margin-bottom: 10px;
    }
    .task-item.completed{
      opacity: 0.6;
      border-color: rgba(100,200,100,0.35);
    }
    .task-text{
      font-size: 14px;
      color: var(--brass-0);
      margin-bottom: 6px;
    }
    .task-progress{
      font-size: 13px;
      color: var(--brass-1);
      margin-bottom: 4px;
    }
    .task-reward{
      font-size: 12px;
      color: var(--muted);
    }

    /* Rewards */
    .reward-item{
      display: flex;
      align-items: center;
      gap: 12px;
      background:
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.55)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.18);
      border-radius: var(--radius);
      padding: 12px;
      margin-bottom: 10px;
    }
    .reward-item.locked{
      opacity: 0.5;
    }
    .reward-icon{
      font-size: 32px;
    }
    .reward-text{
      flex: 1;
      font-size: 14px;
      color: var(--brass-0);
    }
    .reward-progress{
      font-size: 12px;
      color: var(--muted);
    }
    .claim-btn{
      all: unset;
      padding: 8px 16px;
      background: linear-gradient(180deg, var(--brass-0), var(--brass-1));
      color: var(--bg-dark);
      border-radius: 8px;
      font-size: 13px;
      cursor: pointer;
      font-weight: 500;
    }

    /* Equipment */
    .equipment-slot{
      background:
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.55)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.18);
      border-radius: var(--radius);
      padding: 12px;
      margin-bottom: 10px;
    }
    .slot-name{
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }
    .slot-item{
      font-size: 14px;
      color: var(--brass-0);
      margin-bottom: 4px;
    }
    .slot-item.equipped{
      color: var(--brass-1);
    }
    .slot-bonus{
      font-size: 13px;
      color: #8bc34a;
    }

    /* Collections */
    .collection-set{
      background:
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.55)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.18);
      border-radius: var(--radius);
      padding: 12px;
      margin-bottom: 10px;
    }
    .collection-set.completed{
      border-color: rgba(100,200,100,0.45);
    }
    .set-name{
      font-size: 14px;
      color: var(--brass-0);
      margin-bottom: 6px;
    }
    .set-progress{
      font-size: 13px;
      color: var(--brass-1);
      margin-bottom: 4px;
    }
    .set-bonus{
      font-size: 12px;
      color: #8bc34a;
    }

    /* ===== COLLECTIONS ===== */

    .collections-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      padding: 10px;
    }

    .collection-tile {
      background: radial-gradient(circle at top, #2a2a2a, #0f0f0f);
      border: 1px solid #3a3a3a;
      border-radius: 10px;
      padding: 8px;
      text-align: center;
      cursor: pointer;
      filter: grayscale(1);
      transition: 0.2s;
    }

    .collection-tile:hover {
      filter: grayscale(0);
      box-shadow: 0 0 12px rgba(0,180,255,0.25);
    }

    .collection-tile.locked {
      opacity: 0.4;
    }

    .collection-cover {
      width: 100%;
      aspect-ratio: 1 / 1;
      background: linear-gradient(145deg,#111,#222);
      border-radius: 6px;
      margin-bottom: 6px;
    }

    .collection-name {
      font-weight: bold;
      font-size: 13px;
    }

    .collection-progress {
      font-size: 12px;
      color: #7fdcff;
    }

    /* ===== COLLECTION DETAILS ===== */

    .collection-bonus {
      margin: 10px;
      padding: 8px;
      border: 1px dashed #3fa9f5;
      color: #9fdcff;
      font-size: 13px;
    }

    .collection-cards-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      padding: 10px;
    }

    .collection-card {
      aspect-ratio: 2 / 3;
      background: #222;
      border-radius: 6px;
      filter: grayscale(1);
      position: relative;
    }

    .collection-card.owned {
      filter: none;
      box-shadow: 0 0 8px rgba(0,255,120,0.3);
    }

    .collection-card.locked::after {
      content: "ðŸ”’";
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    /* Upgrade hint styling */
    .hint {
      transition: all 0.3s ease;
    }
    
    .hint.hot {
      border-color: rgba(120,255,160,.35) !important;
      box-shadow: inset 0 0 14px rgba(0,0,0,.65), 0 0 18px rgba(90,255,120,.18) !important;
      color: rgba(220,255,220,.95) !important;
    }

    /* Card Details Page */
    .card-main-display {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 24px;
      padding: 20px;
      background: linear-gradient(180deg, rgba(242,208,122,0.08), rgba(0,0,0,0.3));
      border: 2px solid rgba(242,208,122,0.3);
      border-radius: 12px;
      margin-bottom: 15px;
    }

    /* ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ— ÐºÐ°Ñ€Ñ‚Ð¸ */
    .card-info-container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: left;
      margin-top: 0;
      margin-left: 0;
    }

    .card-display-image {
      width: 120px;
      height: 160px;
      margin: 0 auto 15px;
      position: relative;
      border-radius: 8px;
      overflow: hidden;
      border: 2px solid rgba(242,208,122,0.4);
      background: radial-gradient(circle at 30% 30%, rgba(255,230,170,0.1), transparent);
    }

    .card-display-icon {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
    }

    .card-display-name {
      font-size: 18px;
      color: var(--brass-0);
      margin-bottom: 8px;
      font-weight: bold;
    }

    .card-display-element {
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .card-display-level {
      display: inline-block;
      background: rgba(242,208,122,0.2);
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 14px;
      color: var(--brass-1);
      margin: 0 5px;
    }

    .card-display-power {
      display: inline-block;
      background: rgba(160,200,100,0.2);
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 14px;
      color: #8bc34a;
      margin: 0 5px;
    }

    .card-stats {
      padding: 15px;
      background: rgba(50,30,20,0.3);
      border-left: 3px solid var(--brass-0);
      margin-bottom: 15px;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid rgba(242,208,122,0.1);
    }

    .stat-row:last-child {
      border-bottom: none;
    }

    .stat-label {
      color: var(--muted);
      font-size: 13px;
    }

    .stat-value {
      color: var(--brass-0);
      font-weight: bold;
    }

    .card-comparison {
      margin-bottom: 15px;
    }

    .comparison-title {
      font-size: 14px;
      color: var(--brass-0);
      margin-bottom: 10px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(242,208,122,0.2);
    }

    .weaker-cards {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }

    .weaker-card-item {
      background: rgba(50,30,20,0.4);
      border: 1px solid rgba(242,208,122,0.15);
      border-radius: 8px;
      padding: 10px;
      transition: all 0.2s;
    }

    .weaker-card-item:hover {
      border-color: rgba(242,208,122,0.3);
      box-shadow: 0 0 10px rgba(242,208,122,0.1);
    }

    .weaker-card-icon {
      font-size: 32px;
      text-align: center;
      margin-bottom: 6px;
    }

    .weaker-card-name {
      font-size: 12px;
      color: var(--brass-0);
      margin-bottom: 4px;
      text-align: center;
    }

    .weaker-card-stats {
      font-size: 11px;
      color: var(--muted);
      text-align: center;
    }

    .no-weaker-cards {
      text-align: center;
      padding: 20px;
      color: var(--muted);
      font-size: 13px;
    }

    /* ÐšÐ¾Ð¼Ð¿Ð°ÐºÑ‚Ð½Ð¸Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº ÑÐ»Ð°Ð±ÑˆÐ¸Ñ… ÐºÐ°Ñ€Ñ‚ */
    .weaker-cards-compact {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 10px;
    }
    .compact-card {
      background: rgba(50,30,20,0.7);
      border: 1.5px solid rgba(242,208,122,0.18);
      border-radius: 10px;
      padding: 10px 8px 8px 8px;
      min-width: 90px;
      max-width: 110px;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.12);
      position: relative;
    }
    .compact-card-icon {
      font-size: 28px;
      margin-bottom: 4px;
    }
    .compact-card-name {
      font-size: 12px;
      color: var(--brass-0);
      margin-bottom: 2px;
      text-align: center;
      font-weight: 600;
    }
    .compact-card-power {
      font-size: 13px;
      color: #f4e6c6;
      margin-bottom: 4px;
      font-weight: 700;
    }
    .absorb-btn {
      background: linear-gradient(180deg, #f2d07a, #c59b3c);
      color: #1a120c;
      border: none;
      border-radius: 6px;
      padding: 4px 10px;
      font-size: 12px;
      font-weight: 700;
      margin-bottom: 2px;
      cursor: pointer;
      transition: background 0.18s;
    }
    .absorb-btn:hover {
      background: linear-gradient(180deg, #ffe7a0, #e0b85c);
    }
    .absorb-bonus {
      font-size: 11px;
      color: #2ecc71;
      font-weight: 700;
      margin-top: 0px;
      margin-bottom: 2px;
      text-align: center;
    }

    /* Card Upgrade Scale (XP System) */
    .card-upgrade {
      margin-top: 14px;
    }

    .upgrade-header {
      display: flex;
      justify-content: space-between;
      font-weight: 900;
      color: rgba(242, 208, 122, 0.95);
    }

    .card-upgrade .xp-bar {
      margin-top: 6px;
      height: 14px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(242, 208, 122, 0.25);
      box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.65);
      overflow: hidden;
    }

    .card-upgrade .xp-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(
        180deg,
        rgba(242, 208, 122, 0.95),
        rgba(122, 85, 32, 0.95)
      );
      box-shadow: 0 0 12px rgba(242, 208, 122, 0.35);
      transition: width 0.25s ease;
    }

    /* Upgrade arrow on card when guaranteed level-up is possible */
    .sp-card { position: relative; overflow: visible; }
    .upgrade-arrow {
      position: absolute;
      left: 50%;
      transform: translate(-50%, 0);
      bottom: -247px !important;           /* ÐŸÐ¾ÐºÐ»Ð°ÑÑ‚Ð¸ Ð¿Ð¾Ð²ÐµÑ€Ñ… ÐºÐ°Ñ€Ñ‚Ð¸ (Ð²ÑÐµÑ€ÐµÐ´Ð¸Ð½Ñ–) */
      top: auto !important;
      width: 32px;           /* ÐœÐµÐ½ÑˆÐ¸Ð¹ Ñ€Ð¾Ð·Ð¼Ñ–Ñ€ */
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(180deg, #30c85a, #0ea83a);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 14px;
      font-weight: 800;
      box-shadow: 0 4px 12px rgba(14, 168, 58, 0.4);
      pointer-events: none;
      z-index: 9999;
      border: 2px solid rgba(255, 255, 255, 0.3);
      animation: pulse-green 1.5s ease-in-out infinite;
    }

    @keyframes pulse-green {
      0%, 100% {
        box-shadow: 0 4px 12px rgba(14, 168, 58, 0.4);
        transform: translateX(-50%) scale(1);
      }
      50% {
        box-shadow: 0 4px 20px rgba(14, 168, 58, 0.6);
        transform: translateX(-50%) scale(1.05);
      }
    }

    /* ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ð¾: ÑÐºÑ‰Ð¾ Ñ…Ð¾Ñ‡ÐµÑ‚Ðµ ÑÑ‚Ñ€Ñ–Ð»ÐºÑƒ Ð¿Ñ–Ð´ ÐºÐ°Ñ€Ñ‚ÐºÐ¾ÑŽ (Ð·Ð¾Ð²Ð½Ñ–) */
    .upgrade-arrow.outside {
      bottom: -16px;         /* Ð’Ð¸ÑÑ‚ÑƒÐ¿Ð°Ñ” Ð¿Ñ–Ð´ ÐºÐ°Ñ€Ñ‚ÐºÐ¾ÑŽ */
      background: linear-gradient(180deg, #30c85a, #0ea83a);
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    #cu-upgrade-btn {
      margin-top: 10px;
      width: 100%;
      padding: 10px;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(242, 208, 122, 0.25);
      color: rgba(244, 230, 198, 0.95);
      font-weight: 900;
      cursor: pointer;
      transition: all 0.2s;
    }

    #cu-upgrade-btn:hover:not(:disabled) {
      background: rgba(0, 0, 0, 0.5);
      box-shadow: 0 0 10px rgba(242, 208, 122, 0.2);
    }

    #cu-upgrade-btn:disabled {
      opacity: 0.45;
      cursor: not-allowed;
    }

    /* === Shop Cards Styles === */
    .shop-filters {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 8px 16px;
      background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
      border: 2px solid #444;
      border-radius: 8px;
      color: #d4af37;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
    }

    .filter-btn:hover {
      background: linear-gradient(135deg, #3a3a3a, #2a2a2a);
      border-color: #d4af37;
      transform: translateY(-2px);
    }

    .filter-btn.active {
      background: linear-gradient(135deg, #d4af37, #b8941f);
      color: #1a1a1a;
      border-color: #d4af37;
    }

    .shop-cards {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      max-height: 400px;
      overflow-y: auto;
      padding: 5px;
    }

    .shop-card {
      background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
      border: 2px solid #444;
      border-radius: 10px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
    }

    .shop-card:hover {
      border-color: #d4af37;
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
    }

    .shop-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .shop-card-name {
      font-size: 14px;
      font-weight: 600;
      color: #d4af37;
    }

    .shop-card-element {
      font-size: 20px;
    }

    .shop-card-stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 12px;
      color: #999;
    }

    .shop-card-power {
      color: #4CAF50;
      font-weight: 600;
    }

    .shop-card-price {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      padding-top: 8px;
      border-top: 1px solid #333;
    }

    .shop-price-tag {
      color: #d4af37;
      font-weight: 600;
      font-size: 14px;
    }

    .shop-buy-btn {
      padding: 6px 12px;
      background: linear-gradient(135deg, #4CAF50, #2e7d32);
      border: none;
      border-radius: 6px;
      color: white;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .shop-buy-btn:hover {
      background: linear-gradient(135deg, #66BB6A, #4CAF50);
      transform: scale(1.05);
    }

    .shop-buy-btn:disabled {
      background: #555;
      cursor: not-allowed;
      opacity: 0.5;
    }

    .shop-card-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 4px 8px;
      background: linear-gradient(135deg, #4CAF50, #2e7d32);
      border-radius: 4px;
      font-size: 10px;
      font-weight: 600;
      color: white;
    }

    .shop-card-badge.upgrade-only {
      background: linear-gradient(135deg, #FF9800, #E65100);
    }

    /* === Shop Tabs & Products === */
    .shop-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      background: linear-gradient(135deg, #1a1a1a, #0a0a0a);
      padding: 8px;
      border-radius: 12px;
      border: 2px solid #333;
    }

    .shop-tab {
      flex: 1;
      padding: 12px;
      background: transparent;
      border: none;
      border-radius: 8px;
      color: #999;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .shop-tab:hover {
      color: #d4af37;
      background: rgba(212, 175, 55, 0.1);
    }

    .shop-tab.active {
      background: linear-gradient(135deg, #d4af37, #b8941f);
      color: #1a1a1a;
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
    }

    .shop-tab-content {
      display: none;
    }

    .shop-tab-content.active {
      display: block;
    }

    .shop-products {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .product-card {
      background:
        radial-gradient(140px 120px at 30% 25%, rgba(255,220,140,0.16), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 2px solid rgba(242,208,122,0.22);
      border-radius: 12px;
      padding: 16px;
      position: relative;
      transition: all 0.3s;
    }

    .product-card:hover {
      border-color: #d4af37;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212, 175, 55, 0.2);
    }

    .product-badge {
      position: absolute;
      top: -8px;
      right: 16px;
      padding: 6px 12px;
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      border-radius: 6px;
      font-size: 11px;
      font-weight: 700;
      color: white;
      box-shadow: 0 2px 8px rgba(231, 76, 60, 0.4);
    }

    .product-badge.hot {
      background: linear-gradient(135deg, #f39c12, #e67e22);
      animation: pulse-badge 2s infinite;
    }

    .product-badge.new {
      background: linear-gradient(135deg, #3498db, #2980b9);
    }

    @keyframes pulse-badge {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .product-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .product-icon {
      width: 48px;
      height: 48px;
      font-size: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
      border-radius: 8px;
      border: 2px solid #444;
    }

    .product-info {
      flex: 1;
    }

    .product-title {
      font-size: 16px;
      font-weight: 600;
      color: #d4af37;
      margin-bottom: 4px;
    }

    .product-desc {
      font-size: 13px;
      color: #999;
    }

    .product-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }

    .product-price {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 18px;
      font-weight: 700;
      color: #d4af37;
    }

    .product-price .currency-icon {
      font-size: 20px;
    }

    .product-buy-btn {
      padding: 10px 20px;
      background: linear-gradient(180deg, var(--brass-0), var(--brass-1));
      border: none;
      border-radius: 8px;
      color: var(--bg-dark);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .product-buy-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
    }

    .product-buy-btn:disabled {
      background: #555;
      cursor: not-allowed;
      opacity: 0.5;
    }

    .product-bonus {
      display: inline-block;
      padding: 4px 8px;
      background: rgba(46, 204, 113, 0.2);
      border: 1px solid #2ecc71;
      border-radius: 4px;
      color: #2ecc71;
      font-size: 11px;
      font-weight: 600;
      margin-top: 8px;
    }

    /* === Pack Opening Modal === */
    .pack-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      z-index: 10000;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s;
    }

    .pack-modal.active {
      display: flex;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .pack-modal-content {
      background:
        radial-gradient(140px 120px at 30% 25%, rgba(255,220,140,0.16), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 3px solid #d4af37;
      border-radius: 16px;
      padding: 18px;
      width: min(360px, calc(100vw - 24px));
      max-width: 460px;
      max-height: 80vh;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
      text-align: center;
      align-items: center;
      animation: slideUp 0.4s;
    }

    @keyframes slideUp {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .pack-modal-header {
      text-align: center;
      margin-bottom: 20px;
    }

    .pack-modal-title {
      font-size: 20px;
      font-weight: 700;
      color: #d4af37;
      margin-bottom: 8px;
    }

    .pack-modal-subtitle {
      font-size: 14px;
      color: #999;
    }

    .pack-rewards {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      flex-wrap: wrap;
      margin-bottom: 6px;
    }

    /* Fallback: keep grid layout on wider pack-opening screens if desired */
    @media (min-width: 900px) {
      .pack-rewards.grid-view {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
      }
    }

    .pack-card-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      animation: cardReveal 0.5s backwards;
    }

    .pack-card-wrapper:nth-child(1) { animation-delay: 0.1s; }
    .pack-card-wrapper:nth-child(2) { animation-delay: 0.2s; }
    .pack-card-wrapper:nth-child(3) { animation-delay: 0.3s; }
    .pack-card-wrapper:nth-child(4) { animation-delay: 0.4s; }
    .pack-card-wrapper:nth-child(5) { animation-delay: 0.5s; }

    .pack-card-wrapper .sp-card {
      width: 100%;
      max-width: 220px;
      aspect-ratio: 160 / 220;
      height: auto;
      margin: 0;
    }

    /* Mobile-friendly adjustments for pack modal */
    @media (max-width: 480px) {
      .pack-rewards { grid-template-columns: 1fr !important; gap: 14px; }
      .pack-modal-content { max-width: 320px; width: 94%; padding: 18px; }
      .pack-card-wrapper { gap: 8px; }
      .pack-card-wrapper .sp-card { max-width: 160px; aspect-ratio: 3/4; }
      .pack-card-info { font-size: 14px; }
      .pack-modal-title { font-size: 18px; }
    }

    .pack-card-info {
      text-align: center;
      color: var(--brass-0);
    }

    .pack-card-name {
      font-size: 16px;
      font-weight: bold;
      color: var(--brass-0);
      margin-bottom: 4px;
      line-height: 1.15;
      word-break: normal;
      overflow-wrap: anywhere;
    }

    .pack-card-element {
      font-size: 13px;
      color: var(--muted);
    }

    .reward-card {
      background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
      border: 2px solid #444;
      border-radius: 10px;
      padding: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
      animation: cardReveal 0.5s backwards;
    }

    .reward-card:nth-child(1) { animation-delay: 0.1s; }
    .reward-card:nth-child(2) { animation-delay: 0.2s; }
    .reward-card:nth-child(3) { animation-delay: 0.3s; }
    .reward-card:nth-child(4) { animation-delay: 0.4s; }
    .reward-card:nth-child(5) { animation-delay: 0.5s; }
    .reward-card:nth-child(n+6) { animation-delay: 0.6s; }

    @keyframes cardReveal {
      from { transform: rotateY(90deg) scale(0.8); opacity: 0; }
      to { transform: rotateY(0) scale(1); opacity: 1; }
    }

    .reward-card-icon {
      font-size: 32px;
      width: 40px;
      text-align: center;
    }

    .reward-card-info {
      flex: 1;
    }

    .reward-card-name {
      font-size: 14px;
      font-weight: 600;
      color: #d4af37;
      margin-bottom: 4px;
    }

    .reward-card-power {
      font-size: 12px;
      color: #4CAF50;
      font-weight: 600;
    }

    /* ÐÐ¾Ð²Ñ– ÑÑ‚Ð¸Ð»Ñ– Ð´Ð»Ñ card-item (ÐºÑ€Ð°ÑÐ¸Ð²Ñ– ÐºÐ°Ñ€Ñ‚Ð¸) */
    .card-item {
      background: linear-gradient(135deg, rgba(255,220,140,0.08), rgba(0,0,0,0.4)),
                  linear-gradient(180deg, #1b1410, #0a0805);
      border: 2px solid rgba(242,208,122,0.25);
      border-radius: 12px;
      overflow: hidden;
      animation: cardReveal 0.5s backwards;
      margin-bottom: 12px;
    }

    .card-item:nth-child(1) { animation-delay: 0.1s; }
    .card-item:nth-child(2) { animation-delay: 0.2s; }
    .card-item:nth-child(3) { animation-delay: 0.3s; }
    .card-item:nth-child(4) { animation-delay: 0.4s; }
    .card-item:nth-child(5) { animation-delay: 0.5s; }
    .card-item:nth-child(n+6) { animation-delay: 0.6s; }

    .card-item-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px;
    }

    .card-item-element {
      font-size: 32px;
      min-width: 40px;
      text-align: center;
    }

    .card-item-details {
      flex: 1;
    }

    .card-item-name {
      font-size: 16px;
      font-weight: 700;
      color: #d4af37;
      margin-bottom: 4px;
    }

    .card-item-element-name {
      font-size: 12px;
      color: #999;
      opacity: 0.8;
    }

    .card-item-power {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 14px 14px;
      border-top: 1px solid rgba(242,208,122,0.12);
    }

    .card-power-label {
      font-size: 12px;
      color: #999;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .card-power-value {
      font-size: 24px;
      font-weight: 800;
      color: #d4af37;
    }

    .pack-modal-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(180deg, var(--brass-0), var(--brass-1));
      border: none;
      border-radius: 10px;
      color: var(--bg-dark);
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
    }

    .pack-modal-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
    }

    /* Duel Result Modal */
    .duel-result-rewards {
      text-align: center;
      padding: 20px;
      font-size: 28px;
      color: var(--brass-0);
      font-weight: 700;
    }
    .duel-result-stats-info {
      text-align: center;
      padding: 10px 20px;
      color: var(--muted);
      font-size: 15px;
    }
    .duel-wins-info {
      font-size: 16px;
      color: var(--brass-1);
    }
    .duel-next-btn {
      background: linear-gradient(180deg, rgba(100,200,100,0.35), rgba(60,150,60,0.35));
      border: 1px solid rgba(100,200,100,0.5);
    }
    .duel-next-btn:hover {
      background: linear-gradient(180deg, rgba(120,220,120,0.45), rgba(80,170,80,0.45));
    }
    .duel-battle-summary {
      margin-top: 20px;
      padding: 20px;
      border-top: 2px solid rgba(242,208,122,0.25);
    }
    .duel-summary-title {
      text-align: center;
      color: var(--muted);
      font-size: 14px;
      margin-bottom: 10px;
    }
    .duel-summary-hp {
      text-align: center;
      font-size: 20px;
      color: #e74c3c;
      font-weight: 700;
      margin-bottom: 15px;
    }
    .duel-battle-cards {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .duel-battle-card-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 12px;
      background: rgba(0,0,0,0.3);
      border-radius: 8px;
      border-left: 3px solid var(--elem);
    }
    .duel-battle-card-player {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .duel-battle-card-enemy {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .duel-battle-card-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: conic-gradient(var(--brass-2) 0 90deg, var(--brass-1) 90deg 180deg, var(--brass-2) 180deg 270deg, var(--brass-1) 270deg 360deg);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .duel-battle-card-icon svg {
      width: 18px;
      height: 18px;
    }
    .duel-battle-card-dmg {
      color: var(--brass-0);
      font-weight: 700;
      font-size: 16px;
    }
    .duel-battle-vs {
      color: var(--muted);
      font-size: 14px;
    }

    /* Multiplier preview badge between cards */
    .mult-badge {
      width: 160px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      background: rgba(0,0,0,0.70);
      border: 1px solid rgba(242,208,122,0.30);
      border-radius: 999px;
      box-shadow: inset 0 0 12px rgba(0,0,0,0.75), 0 8px 20px rgba(0,0,0,0.60);
    }
    .mult-badge .mult-text {
      color: rgba(244,230,198,0.95);
      font-size: 15px;
      font-weight: 700;
      letter-spacing: 0.04em;
    }
    .mult-badge .swords::before {
      content: 'âš”';
      font-size: 16px;
      opacity: 0.90;
    }
    .mult-badge.mult-good .mult-text { color: #7dff9a; text-shadow: 0 0 8px rgba(125,255,154,0.5); }
    .mult-badge.mult-bad .mult-text { color: #ff9a7d; text-shadow: 0 0 8px rgba(255,154,125,0.5); }
    .mult-badge.mult-neutral .mult-text { color: rgba(244,230,198,0.95); }

    /* === New Shop Design === */
    .shop-section {
      margin-bottom: 25px;
    }

    .shop-section-title {
      font-size: 18px;
      font-weight: 700;
      color: #d4af37;
      margin-bottom: 15px;
      padding: 10px 15px;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05));
      border-left: 4px solid #d4af37;
      border-radius: 6px;
    }

    .shop-notice {
      background: linear-gradient(135deg, rgba(52, 152, 219, 0.2), rgba(41, 128, 185, 0.1));
      border: 2px solid rgba(52, 152, 219, 0.4);
      border-radius: 10px;
      padding: 12px 15px;
      margin-bottom: 15px;
      color: #3498db;
      font-size: 13px;
      line-height: 1.5;
      position: relative;
    }

    .shop-notice::before {
      content: 'ðŸ’¡';
      font-size: 20px;
      margin-right: 8px;
    }

    .shop-item-card {
      background:
        radial-gradient(140px 120px at 30% 25%, rgba(255,220,140,0.16), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 2px solid rgba(242,208,122,0.22);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 15px;
      display: flex;
      gap: 15px;
      align-items: center;
      transition: all 0.3s;
      position: relative;
    }

    .shop-item-card:hover {
      border-color: #d4af37;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212, 175, 55, 0.2);
    }

    .shop-item-icon {
      width: 70px;
      height: 70px;
      min-width: 70px;
      background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
      border: 2px solid #444;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
    }

    .shop-item-content {
      flex: 1;
    }

    .shop-item-name {
      font-size: 16px;
      font-weight: 600;
      color: #d4af37;
      margin-bottom: 5px;
    }

    .shop-item-desc {
      font-size: 13px;
      color: #999;
      margin-bottom: 8px;
    }

    .shop-item-chance {
      display: inline-block;
      padding: 4px 10px;
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      border-radius: 15px;
      color: white;
      font-size: 11px;
      font-weight: 700;
      margin-top: 5px;
    }

    .shop-item-chance.rare {
      background: linear-gradient(135deg, #9b59b6, #8e44ad);
    }

    .shop-item-chance.uncommon {
      background: linear-gradient(135deg, #2ecc71, #27ae60);
    }

    .shop-item-action {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
    }

    .shop-item-price {
      font-size: 18px;
      font-weight: 700;
      color: #d4af37;
    }

    .shop-buy-button {
      padding: 10px 20px;
      background: linear-gradient(135deg, #2ecc71, #27ae60);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      white-space: nowrap;
    }

    .shop-buy-button:hover {
      background: linear-gradient(135deg, #27ae60, #229954);
      transform: scale(1.05);
    }

    .shop-buy-button:disabled {
      background: #555;
      cursor: not-allowed;
      opacity: 0.5;
    }

    .action-btn {
      all: unset;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid rgba(242,208,122,0.3);
    }

    .upgrade-btn {
      background: linear-gradient(180deg, #a6ff7a, #2ea13a);
      color: #0b180b;
    }

    .upgrade-btn:hover {
      box-shadow: 0 0 15px rgba(166,255,122,0.4);
    }

    .add-btn {
      background: linear-gradient(180deg, rgba(242,208,122,0.4), rgba(197,155,60,0.2));
      color: var(--brass-0);
    }

    .add-btn:hover {
      background: linear-gradient(180deg, rgba(242,208,122,0.6), rgba(197,155,60,0.3));
    }

    .remove-btn {
      background: rgba(255,50,50,0.1);
      color: #ff6666;
      border-color: rgba(255,50,50,0.2);
    }

    .remove-btn:hover {
      background: rgba(255,50,50,0.2);
    }

    /* Shop */
    .shop-item{
      background:
        radial-gradient(140px 120px at 30% 25%, rgba(255,220,140,0.16), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.22);
      border-radius: var(--radius);
      padding: 12px;
      margin-bottom: 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .item-name{
      font-size: 15px;
      color: var(--brass-0);
    }
    .item-desc{
      font-size: 13px;
      color: var(--muted);
    }
    .item-price{
      font-size: 14px;
      color: var(--brass-1);
      margin: 4px 0;
    }
    .buy-btn{
      all: unset;
      padding: 10px;
      text-align: center;
      background: linear-gradient(180deg, var(--brass-0), var(--brass-1));
      color: var(--bg-dark);
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      font-weight: 500;
    }

    /* Gold packs */
    .gold-pack{
      background:
        radial-gradient(140px 120px at 30% 25%, rgba(255,220,140,0.16), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.22);
      border-radius: var(--radius);
      padding: 15px;
      margin-bottom: 12px;
      text-align: center;
      position: relative;
    }
    .gold-pack.featured{
      border-color: var(--brass-1);
      box-shadow: 0 0 20px rgba(242,208,122,0.25);
    }
    .pack-badge{
      position: absolute;
      top: -8px;
      right: 10px;
      padding: 4px 12px;
      background: linear-gradient(180deg, var(--brass-0), var(--brass-1));
      color: var(--bg-dark);
      font-size: 11px;
      border-radius: 12px;
      font-weight: 500;
    }
    .pack-amount{
      font-size: 20px;
      color: var(--brass-0);
      margin-bottom: 8px;
    }
    .pack-price{
      font-size: 15px;
      color: var(--brass-1);
      margin-bottom: 8px;
    }
    .pack-bonus{
      font-size: 13px;
      color: #8bc34a;
      margin-bottom: 8px;
    }
    .exchange-btn{
      all: unset;
      display: block;
      width: 100%;
      padding: 12px;
      text-align: center;
      background: linear-gradient(180deg, var(--brass-0), var(--brass-1));
      color: var(--bg-dark);
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      font-weight: 500;
    }

    /* Profile stats */
    .profile-stat{
      background:
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.55)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.18);
      border-radius: var(--radius);
      padding: 12px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .stat-label{
      font-size: 14px;
      color: var(--muted);
    }
    .stat-value{
      font-size: 16px;
      color: var(--brass-0);
      font-weight: 500;
    }

    /* Guild status */
    .guild-status{
      background:
        radial-gradient(140px 120px at 30% 25%, rgba(255,220,140,0.16), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.22);
      border-radius: var(--radius);
      padding: 20px;
      margin-bottom: 15px;
      text-align: center;
    }
    .status-text{
      font-size: 15px;
      color: var(--brass-0);
    }

    /* Accordion list */
    .list{
      margin-top: 12px;
      border-radius: var(--radius);
      overflow:hidden;
      border: 1px solid rgba(242,208,122,0.18);
      box-shadow: 0 12px 22px rgba(0,0,0,0.55);
      background:
        linear-gradient(180deg, rgba(255,220,140,0.06), rgba(0,0,0,0.45)),
        linear-gradient(180deg, #1b120c, #0b0806);
    }

    .item{
      border-top: 1px solid rgba(242,208,122,0.10);
    }
    .item:first-child{ border-top:none; }

    .item > button{
      all:unset;
      display:flex;
      align-items:center;
      width:100%;
      padding: 12px 12px;
      cursor:pointer;
      gap:10px;
    }
    .item > button:hover{ background: rgba(255,210,120,0.05); }

    .item .bullet{
      width:22px; height:22px;
      border-radius: 7px;
      background:
        linear-gradient(180deg, var(--brass-0), var(--brass-2));
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.5), 0 0 10px rgba(255,210,120,0.18);
      position:relative;
    }
    .item .bullet::after{
      content:"";
      position:absolute; inset:5px;
      border-radius: 6px;
      background:
        radial-gradient(circle at 35% 35%, rgba(255,255,255,0.22), transparent 55%),
        linear-gradient(180deg, #3a2e1f, #14100c);
      opacity:0.9;
    }

    .item .text{
      flex:1;
      font-size: 15px;
      letter-spacing:0.02em;
    }
    .item .chev{
      width: 10px; height:10px;
      border-right: 2px solid rgba(242,208,122,0.7);
      border-bottom: 2px solid rgba(242,208,122,0.7);
      transform: rotate(-45deg);
      transition: transform .12s ease;
      opacity:0.9;
      margin-right: 4px;
    }

    /* Promo */
    .promo{
      margin-top: 10px;
      border-radius: var(--radius);
      padding: 10px 12px;
      background:
        radial-gradient(400px 200px at 50% 0%, rgba(255,210,120,0.12), transparent 55%),
        linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.22);
      box-shadow: 0 12px 22px rgba(0,0,0,0.55);
      text-align:center;
    }
    .promo .badge{
      display:inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      background: linear-gradient(180deg, var(--copper-0), var(--copper-2));
      border: 1px solid rgba(255,220,140,0.25);
      color: #1c0f08;
      font-weight: 700;
      letter-spacing:0.03em;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.45);
      margin-bottom: 6px;
    }
    .promo .line{
      color: var(--brass-0);
      font-weight: 700;
      text-shadow: 0 1px 0 rgba(0,0,0,0.75);
    }
    .promo .sub{
      margin-top: 4px;
      font-size: 12px;
      color: var(--muted);
    }

    /* Bottom nav */
    .bottom{
      position: sticky;
      bottom: 8px;
      margin-top: 12px;
      border-radius: 18px;
      background:
        linear-gradient(180deg, rgba(255,220,140,0.06), rgba(0,0,0,0.65)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.18);
      box-shadow: 0 16px 26px rgba(0,0,0,0.65);
      display:flex;
      gap:6px;
      padding: 8px;
    }
    .navbtn{
      flex:1;
      border-radius: 14px;
      padding: 10px 8px;
      text-align:center;
      cursor:pointer;
      user-select:none;
      border: 1px solid rgba(242,208,122,0.10);
      background:
        linear-gradient(180deg, rgba(255,210,120,0.04), rgba(0,0,0,0.45));
      transition: filter .08s ease, transform .08s ease;
    }
    .navbtn:hover{ filter: brightness(1.06); }
    .navbtn:active{ transform: translateY(1px); }

    .navbtn .ico{
      width:24px; height:24px;
      margin: 0 auto 6px;
      border-radius: 10px;
      background:
        radial-gradient(circle at 35% 35%, rgba(255,230,170,0.18), transparent 60%),
        linear-gradient(180deg, #2f1f14, #120c08);
      border: 1px solid rgba(242,208,122,0.22);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.6);
      position:relative;
      overflow:hidden;
    }
    .navbtn .ico::after{
      content:"";
      position:absolute; inset:-50%;
      background: repeating-conic-gradient(from 0deg, rgba(242,208,122,0.10) 0 12deg, transparent 12deg 24deg);
      opacity:0.55;
    }
    .navbtn .t{
      font-size: 12px;
      color: var(--muted);
      letter-spacing:0.02em;
    }
    .navbtn.active{
      border-color: rgba(242,208,122,0.32);
      background:
        radial-gradient(220px 80px at 50% 0%, rgba(255,210,120,0.16), transparent 65%),
        linear-gradient(180deg, rgba(255,210,120,0.06), rgba(0,0,0,0.55));
    }
    .navbtn.active .t{ color: var(--brass-0); }

    /* Small screens */
    @media (max-width: 360px){
      .tile{ min-height: 90px; }
      .tile .label{ font-size: 12px; }
      .tile .sub{ font-size: 11px; }
    }

    /* ===== DECK SCREEN ===== */
    .screen {
      width: 100vw;
      max-width: none;
      margin: 0;
      padding: 0;
    }

    /* Topbar Ð´Ð»Ñ ÐºÐ¾Ð»Ð¾Ð´Ð¸ */
    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      border-radius: 16px;
      background: 
        linear-gradient(180deg, rgba(255,210,120,.06), rgba(0,0,0,.55)),
        linear-gradient(180deg, #1b120c, #070503);
      border: 1px solid rgba(242,208,122,.20);
      box-shadow: 0 14px 26px rgba(0,0,0,.65);
      margin-bottom: 10px;
    }

    .topbar-right {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .pill {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(242,208,122,.18);
      box-shadow: inset 0 0 10px rgba(0,0,0,.65);
      font-size: 14px;
      color: var(--brass-0);
      font-weight: 600;
    }

    .gem, .coin {
      width: 10px;
      height: 10px;
      display: inline-block;
    }

    .gem {
      border-radius: 2px;
      background: linear-gradient(135deg, #bfe8ff, #4aa0d6);
      box-shadow: 0 0 6px rgba(79, 180, 240, 0.5);
    }

    .coin {
      border-radius: 50%;
      background: linear-gradient(135deg, var(--brass-0), var(--brass-1));
      box-shadow: 0 0 6px rgba(242,208,122, 0.5);
    }

    /* Panel helper */
    .panel {
      background:
        linear-gradient(180deg, rgba(255,210,120,.05), rgba(0,0,0,.55)),
        linear-gradient(180deg, #1b120c, #070503);
      border: 1px solid rgba(242,208,122,.18);
      box-shadow: 0 14px 24px rgba(0,0,0,.6), inset 0 0 14px rgba(0,0,0,.7);
      border-radius: 14px;
    }

    .subtle {
      opacity: 0.95;
    }

    /* Deck header */
    .deck-header {
      padding: 10px 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .deck-title {
      font-weight: 800;
      letter-spacing: 0.06em;
      color: var(--brass-0);
      font-size: 14px;
    }

    .deck-power {
      font-weight: 800;
      color: var(--brass-0);
      font-size: 16px;
    }

    /* Hint */
    .hint {
      padding: 8px 12px;
      text-align: center;
      color: rgba(244,230,198,.92);
      font-size: 13px;
      margin-bottom: 10px;
    }

    /* Card base styles */
    .sp-card {
      /* ÐšÐ¾Ð¼Ð¿Ð°ÐºÑ‚Ð½Ð¸Ð¹ Ñ€Ð¾Ð·Ð¼Ñ–Ñ€ */
      width: 200px;
      height: 260px;
      border-radius: 20px;
      position: relative;
      padding: 12px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;

      --elem: var(--fire); /* default */
      --rar: var(--legend); /* default rarity */

      background:
        radial-gradient(200px 180px at 40% 20%, rgba(255,220,140,.14), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.72)),
        linear-gradient(180deg, #1b120c, #080604);

      box-shadow:
        0 15px 30px var(--shadow),
        inset 0 0 18px rgba(0,0,0,.78),
        0 0 18px color-mix(in srgb, var(--elem) 22%, transparent);

      border: 1px solid rgba(242,208,122,.22);
    }

    .sp-card:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow:
        0 20px 40px var(--shadow),
        inset 0 0 18px rgba(0,0,0,.78),
        0 0 25px color-mix(in srgb, var(--elem) 35%, transparent);
    }

    .sp-card.selected {
      box-shadow:
        0 20px 40px var(--shadow),
        inset 0 0 18px rgba(0,0,0,.78),
        0 0 35px color-mix(in srgb, var(--elem) 50%, transparent),
        0 0 0 3px var(--rar);
    }

    /* Metal rim with rarity color */
    .sp-card::before{
      content:"";
      position:absolute;
      inset: 8px;
      border-radius: 16px;
      background:
        linear-gradient(135deg,
          color-mix(in srgb, var(--rar) 30%, rgba(242,208,122,.62)),
          color-mix(in srgb, var(--rar) 20%, rgba(181,106,51,.25)),
          color-mix(in srgb, var(--rar) 15%, rgba(122,85,32,.2)));
      box-shadow:
        inset 0 0 0 1px rgba(0,0,0,.6),
        inset 0 0 16px rgba(0,0,0,.6);
      pointer-events:none;
      opacity:.95;
      z-index: 1;
    }

    /* Inner plate */
    .sp-card::after{
      content:"";
      position:absolute;
      inset: 14px;
      border-radius: 14px;
      background:
        radial-gradient(400px 320px at 50% 20%, rgba(255,210,120,.08), transparent 58%),
        linear-gradient(180deg, rgba(255,210,120,.04), rgba(0,0,0,.40)),
        linear-gradient(180deg, #241a12, #120c08);
      box-shadow:
        inset 0 0 0 1px rgba(242,208,122,.10),
        inset 0 0 14px rgba(0,0,0,.65);
      pointer-events:none;
      z-index: 1;
    }

    /* Content layer */
    .sp-card > *{ position:relative; z-index:2; }

    /* Upgradable card - green arrow indicator (ÑÐº Ð¾ÐºÑ€ÐµÐ¼Ð¸Ð¹ ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚) */
    .upgrade-dot {
      position: absolute;
      top: -12px;
      right: 8px;
      width: 26px;
      height: 26px;
      border-radius: 999px;
      display: grid;
      place-items: center;
      
      color: #0b180b;
      background: linear-gradient(180deg, #a6ff7a, #2ea13a);
      border: 1px solid rgba(0,0,0,.45);
      box-shadow: 0 6px 14px rgba(0,0,0,.6), 0 0 16px rgba(90,255,120,.25);
      font-weight: 900;
      font-size: 14px;
      cursor: pointer;
      animation: pulse-upgrade 1.5s ease-in-out infinite;
      z-index: 10;
    }
    .corner-gear {
      position: absolute;
      top: 16px;
      left: 16px;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      z-index: 3;
      
      background:
        conic-gradient(
          from 0deg,
          var(--brass-2) 0 15deg,
          var(--brass-1) 15deg 30deg,
          var(--brass-2) 30deg 45deg,
          var(--brass-1) 45deg 60deg,
          var(--brass-2) 60deg 75deg,
          var(--brass-1) 75deg 90deg,
          var(--brass-2) 90deg 105deg,
          var(--brass-1) 105deg 120deg,
          var(--brass-2) 120deg 135deg,
          var(--brass-1) 135deg 150deg,
          var(--brass-2) 150deg 165deg,
          var(--brass-1) 165deg 180deg,
          var(--brass-2) 180deg 195deg,
          var(--brass-1) 195deg 210deg,
          var(--brass-2) 210deg 225deg,
          var(--brass-1) 225deg 240deg,
          var(--brass-2) 240deg 255deg,
          var(--brass-1) 255deg 270deg,
          var(--brass-2) 270deg 285deg,
          var(--brass-1) 285deg 300deg,
          var(--brass-2) 300deg 315deg,
          var(--brass-1) 315deg 330deg,
          var(--brass-2) 330deg 345deg,
          var(--brass-1) 345deg 360deg
        );
      
      box-shadow:
        inset 0 0 0 2px rgba(0,0,0,.6),
        0 5px 12px rgba(0,0,0,.7),
        0 0 12px color-mix(in srgb, var(--elem) 40%, transparent);
      
      display: grid;
      place-items: center;
      transition: transform 0.6s ease;
    }

    .sp-card:hover .corner-gear {
      transform: rotate(180deg);
    }

    /* Ð¦ÐµÐ½Ñ‚Ñ€ ÑˆÐµÑÑ‚ÐµÑ€Ð½Ñ– */
    .corner-gear::before{
      content:"";
      position:absolute;
      inset: 8px;
      border-radius: 50%;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.25), transparent 60%),
        linear-gradient(180deg, #2a1c12, #0a0604);
      box-shadow: inset 0 0 8px rgba(0,0,0,.8);
      z-index: -1;
    }

    /* Ð†ÐºÐ¾Ð½ÐºÐ° ÑÑ‚Ð¸Ñ…Ñ–Ñ— Ð²ÑÐµÑ€ÐµÐ´Ð¸Ð½Ñ– ÑˆÐµÑÑ‚ÐµÑ€Ð½Ñ– */
    .corner-gear svg{
      width: 22px;
      height: 22px;
      fill: var(--elem);
      filter:
        drop-shadow(0 0 6px color-mix(in srgb, var(--elem) 60%, transparent))
        drop-shadow(0 2px 4px rgba(0,0,0,.8));
      position: relative;
      z-index: 2;
    }
    
    .power-plate {
      position: absolute;
      bottom: 16px;
      left: 50%;
      transform: translateX(-50%);
      width: 70%;
      height: 50px;
      border-radius: 12px;
      
      background:
        radial-gradient(180px 60px at 50% 0%, rgba(255,210,120,.15), transparent 70%),
        linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.65)),
        linear-gradient(180deg, #1b120c, #080604);
      
      border: 1px solid rgba(242,208,122,.25);
      box-shadow: 
        inset 0 0 12px rgba(0,0,0,.75),
        0 6px 16px rgba(0,0,0,.6),
        inset 0 0 0 1px rgba(0,0,0,.6);
      
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 3;
    }

    .sp-card:hover .power-plate {
      box-shadow: 
        inset 0 0 12px rgba(0,0,0,.75),
        0 8px 20px rgba(0,0,0,.7),
        inset 0 0 0 1px rgba(0,0,0,.6),
        0 0 15px color-mix(in srgb, var(--elem) 30%, transparent);
    }

    .sp-card.selected .power-plate {
      background:
        radial-gradient(180px 60px at 50% 0%, rgba(255,210,120,.20), transparent 70%),
        linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.65)),
        linear-gradient(180deg, color-mix(in srgb, var(--rar) 15%, #1b120c), color-mix(in srgb, var(--rar) 10%, #080604));
    }
    
    .power-value {
      font-size: 32px;
      font-weight: 900;
      color: var(--brass-0);
      font-variant-numeric: tabular-nums;
      text-shadow:
        0 2px 0 rgba(0,0,0,.75),
        0 0 12px rgba(255,210,120,.25);
      transition: all 0.3s ease;
    }

    .sp-card.selected .power-value {
      color: color-mix(in srgb, var(--rar) 40%, var(--brass-0));
      text-shadow:
        0 2px 0 rgba(0,0,0,.75),
        0 0 20px color-mix(in srgb, var(--rar) 50%, transparent);
    }
    
    .rarity-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      padding: 4px 10px;
      border-radius: 10px;
      background: rgba(0,0,0,0.8);
      border: 1px solid var(--rar);
      color: var(--rar);
      font-size: 10px;
      font-weight: bold;
      letter-spacing: 1px;
      z-index: 3;
      text-transform: uppercase;
    }

    /* Deck Grid 3x3 */
    .deck-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 16px;
      align-items: start;
      justify-items: center;
    }

    /* ÐšÐ°Ñ€Ñ‚Ð¸ Ð² ÐºÐ¾Ð»Ð¾Ð´Ñ– Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑŽÑ‚ÑŒ ÑÑ‚Ð¸Ð»Ñ– Ð· steampunk-cards.css */


    /* ===== DUEL SCREEN ===== */
    .duel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }
    .duel-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--brass-0);
    }
    .duel-start-btn {
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid rgba(242,208,122,.25);
      background: linear-gradient(180deg, rgba(242,208,122,.25), rgba(0,0,0,.35));
      color: var(--brass-0);
      cursor: pointer;
    }
    .duel-hud {
      display: flex;
      gap: 12px;
      margin-bottom: 10px;
    }
    .duel-hp {
      flex: 1;
      padding: 10px;
      border: 1px solid rgba(242,208,122,.18);
      border-radius: 10px;
      background: linear-gradient(180deg, rgba(255,220,140,.06), rgba(0,0,0,.35));
      color: var(--brass-0);
    }
    .enemy-hand, .player-hand {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin: 10px 0 0px;
    }
    .player-hand {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin: 0px 0 8px;
    }
    .duel-multipliers {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin: 12px 0;
      min-height: 32px;
    }
    .duel-log {
      min-height: 50px;
      padding: 8px;
      margin: 0px 0 10px;
      border: 1px dashed rgba(242,208,122,.2);
      border-radius: 10px;
      color: var(--muted);
      font-size: 11px;
      line-height: 1.4;
      text-align: center;
    }

    /* HUD: avatar + HP bar for enemy/player */
    .hud-status{
      display:flex;
      align-items:center;
      gap:12px;
      justify-content:center;
      margin:8px 0;
    }
    .hud-status .avatar{
      width:56px;
      height:56px;
      border-radius:10px;
      background: linear-gradient(180deg, #2f1f14, #120c08);
      border: 2px solid rgba(242,208,122,0.16);
      box-shadow: inset 0 0 6px rgba(0,0,0,0.6), 0 6px 12px rgba(0,0,0,0.5);
      display:flex; align-items:center; justify-content:center; color:var(--brass-0); font-weight:800;
    }
    .hud-status .avatar.enemy-avatar{ box-shadow: inset 0 0 8px rgba(120,40,20,0.6), 0 6px 12px rgba(0,0,0,0.6); }
    .hud-status .avatar.player-avatar{ box-shadow: inset 0 0 8px rgba(40,120,20,0.6), 0 6px 12px rgba(0,0,0,0.6); }
    .hud-status .hp-wrapper{ flex:1; min-width:220px; }
    .hp-label{ font-size:13px; color:var(--muted); margin-bottom:6px; text-align:left; }
    .hp-bar{ height:12px; background: rgba(0,0,0,0.35); border-radius:10px; border:1px solid rgba(242,208,122,0.12); overflow:hidden; }
    .hp-fill{ height:100%; width:0%; background: linear-gradient(90deg, #4CAF50, #2e7d32); box-shadow: 0 0 8px rgba(46,204,113,0.12); transition: width 0.28s ease; }

    .preduel-body {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin: 12px 0;
    }
    .preduel-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 12px;
      border: 1px solid rgba(242,208,122,0.18);
      border-radius: 10px;
      background: linear-gradient(180deg, rgba(255,220,140,0.06), rgba(0,0,0,0.25));
      color: var(--ink);
      font-weight: 600;
    }
    .preduel-label { color: var(--muted); font-weight: 500; }
    .preduel-value { color: var(--brass-0); }
    .preduel-actions { display: flex; gap: 10px; justify-content: center; margin-top: 10px; }
    .duel-hand .sp-card, .enemy-hand .sp-card, .player-hand .sp-card {
      width: 160px;
      height: 220px;
    }
    /* Ensure duel grid cards have consistent size (desktop + mobile grid) */
    .duel-deck .sp-card,
    .duel-deck.mobile-grid .sp-card {
      width: 140px;
      height: 200px;
      min-width: 120px;
      min-height: 180px;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    /* Slightly smaller cards for narrow screens */
    @media (max-width: 600px) {
      .duel-deck .sp-card,
      .duel-deck.mobile-grid .sp-card {
        width: 110px;
        height: 160px;
        min-width: 100px;
        min-height: 140px;
      }
    }
    /* Extras section */
    .extras-title {
      margin: 14px 4px 8px;
      color: rgba(242,208,122,.85);
      letter-spacing: 0.06em;
      text-align: center;
      font-weight: 700;
      font-size: 13px;
    }

    .extras-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 8px;
    }

    /* === Ð•Ð›Ð•ÐœÐ•ÐÐ¢Ð˜ Ð¡Ð¢Ð˜Ð¥Ð†Ð‡ === */
    .sp-card.fire  { --elem: var(--fire); }
    .sp-card.water { --elem: var(--water); }
    .sp-card.air   { --elem: var(--air); }
    .sp-card.earth { --elem: var(--earth); }
    .sp-card.steam { --elem: var(--steam); }
    .sp-card.mech  { --elem: var(--mech); }

    /* === Ð Ð†Ð”ÐšÐžÐ¡Ð¢Ð† === */
    .sp-card.common  { --rar: var(--common); }
    .sp-card.rare    { --rar: var(--rare); }
    .sp-card.epic    { --rar: var(--epic); }
    .sp-card.legend  { --rar: var(--legend); }

    /* ÐÐ½Ñ–Ð¼Ð°Ñ†Ñ–Ñ ÑÐ²Ñ–Ñ‚Ñ–Ð½Ð½Ñ */
    @media (prefers-reduced-motion: no-preference){
      .sp-card{
        animation: subtle-glow 3s ease-in-out infinite;
      }
      @keyframes subtle-glow{
        0%,100%{ filter: brightness(1.00); }
        50%    { filter: brightness(1.05); }
      }
    }

    .extra-slot {
      padding: 10px 8px;
      text-align: center;
      min-height: 90px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 8px;
    }

    .slot-icon {
      width: 38px;
      height: 38px;
      margin: 0 auto;
      border-radius: 12px;
      background: linear-gradient(180deg, #2f1f14, #120c08);
      border: 1px solid rgba(242,208,122,.20);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.6);
      opacity: 0.75;
    }

    .slot-text {
      font-size: 12px;
      color: rgba(244,230,198,.86);
    }

    /* Link-like button */
    .link-like {
      text-align: center;
      color: rgba(159, 214, 255, .85);
      font-size: 12px;
      text-decoration: underline;
      cursor: pointer;
      margin-bottom: 12px;
    }

    .link-like:hover {
      color: rgba(159, 214, 255, 1);
    }

    /* Menu list */
    .menu-list {
      padding: 6px;
    }

    .menu-row {
      width: 100%;
      background: transparent;
      color: rgba(244,230,198,.92);
      border: 1px solid rgba(242,208,122,.10);
      border-radius: 12px;
      padding: 12px 10px;
      margin: 6px 0;
      text-align: left;
      cursor: pointer;
      font-family: Georgia, "Times New Roman", serif;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    .menu-row:hover {
      border-color: rgba(242,208,122,.25);
      background: rgba(255,210,120,.04);
    }

    .menu-row:active {
      transform: translateY(1px);
    }

    /* Auth overlay */
    .auth-overlay{
      position: fixed;
      inset: 0;
      background: rgba(8, 6, 5, 0.95);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 0.3s ease;
    }
    .auth-overlay.hidden{
      opacity: 0;
      pointer-events: none;
      display: none;
    }

    .auth-box{
      width: min(380px, 90vw);
      background:
        linear-gradient(180deg, rgba(255,220,140,0.08), rgba(0,0,0,0.45)),
        linear-gradient(180deg, #1b120c, #0b0806);
      border: 1px solid rgba(242,208,122,0.22);
      border-radius: var(--radius);
      padding: 24px 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.75);
      position: relative;
    }
    .auth-box::before{
      content:"";
      position:absolute; inset:-1px;
      border-radius: var(--radius);
      background: linear-gradient(135deg, rgba(242,208,122,0.35), rgba(213,143,85,0.18), rgba(90,50,20,0.10));
      mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      padding: 1px;
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events:none;
    }

    .auth-title{
      font-size: 24px;
      font-weight: 700;
      color: var(--brass-0);
      text-align: center;
      margin-bottom: 8px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.7);
    }
    .auth-subtitle{
      font-size: 13px;
      color: var(--muted);
      text-align: center;
      margin-bottom: 24px;
    }

    .auth-tabs{
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      background: rgba(0,0,0,0.3);
      border-radius: 10px;
      padding: 4px;
    }
    .auth-tab{
      flex: 1;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      color: var(--muted);
      font-size: 14px;
      transition: all 0.2s ease;
      border: 1px solid transparent;
    }
    .auth-tab:hover{
      background: rgba(255,210,120,0.05);
    }
    .auth-tab.active{
      background: linear-gradient(180deg, var(--brass-0), var(--brass-2));
      color: #14100c;
      font-weight: 700;
      border-color: rgba(255,230,140,0.3);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.4);
    }

    .auth-form{
      display: none;
    }
    .auth-form.active{
      display: block;
    }

    .form-group{
      margin-bottom: 16px;
    }
    .form-label{
      display: block;
      font-size: 13px;
      color: var(--brass-0);
      margin-bottom: 6px;
      font-weight: 600;
    }
    .form-input{
      width: 100%;
      padding: 12px 14px;
      background:
        linear-gradient(180deg, rgba(0,0,0,0.4), rgba(0,0,0,0.6)),
        linear-gradient(180deg, #1a120c, #0c0907);
      border: 1px solid rgba(242,208,122,0.22);
      border-radius: 10px;
      color: var(--ink);
      font-family: Georgia, "Times New Roman", serif;
      font-size: 15px;
      box-shadow: inset 0 0 12px rgba(0,0,0,0.6);
      transition: border-color 0.2s ease;
    }
    .form-input:focus{
      outline: none;
      border-color: rgba(242,208,122,0.45);
      box-shadow: inset 0 0 12px rgba(0,0,0,0.6), 0 0 0 2px rgba(242,208,122,0.15);
    }
    .form-input::placeholder{
      color: rgba(208, 191, 154, 0.5);
    }

    .auth-btn{
      width: 100%;
      padding: 14px;
      background: linear-gradient(180deg, var(--brass-0), var(--brass-2));
      border: 1px solid rgba(255,230,140,0.35);
      border-radius: 12px;
      color: #14100c;
      font-family: Georgia, "Times New Roman", serif;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.15s ease;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.35), 0 6px 16px rgba(0,0,0,0.4);
      text-shadow: 0 1px 0 rgba(255,255,255,0.2);
    }
    .auth-btn:hover{
      filter: brightness(1.08);
      transform: translateY(-1px);
    }
    .auth-btn:active{
      transform: translateY(0);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.35), 0 2px 8px rgba(0,0,0,0.4);
    }

    .auth-error{
      display: none;
      margin-top: 12px;
      padding: 10px 12px;
      background: rgba(180, 50, 40, 0.2);
      border: 1px solid rgba(220, 80, 60, 0.4);
      border-radius: 8px;
      color: #ffcccc;
      font-size: 13px;
      text-align: center;
    }
    .auth-error.show{
      display: block;
    }
    .burn-arrow {
      position: absolute;
      left: 8px;
      bottom: 8px;
      font-size: 1.5rem;
      color: #3cff3c;
      line-height: 1;
      font-weight: bold;
      pointer-events: none;
      z-index: 2;
      text-shadow: 0 2px 8px #000a, 0 0 6px #3cff3c99;
      filter: drop-shadow(0 0 2px #000) drop-shadow(0 0 4px #3cff3c);
      background: none;
      border-radius: 50%;
      padding: 0;
    }
    .weaker-card-item {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 180px;
    }
    /* Mobile: force 3 cards per row and compact card tiles */
    @media (max-width: 480px) {
      .collection-grid {
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 6px;
      }
      .collection-card-item {
        padding: 6px 4px;
        min-height: 70px;
      }
      .collection-card-name { font-size: 12px; }
      .collection-card-status { font-size: 10px; }
    }
    /* Canonical 3x3 layout for narrow screens (<=425px) to prevent reflow/pulsation */
    @media (max-width: 430px) {
      /* remove extra container paddings that break available width */
      #app-shell { padding-left: 4px; padding-right: 4px; }
      #root, .container { padding-left: 0; padding-right: 0; }

      /* canonical grid for decks and lists */
      .deck-grid, .grid-3x3, .duel-deck {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 6px;
        width: 100%;
        margin: 0;
        padding: 0 4px;
        align-items: start;
        align-content: start;
      }

      /* card sizing: grid controls width, card keeps fixed aspect-ratio (no px widths) */
      .deck-grid .sp-card,
      .grid-3x3 .sp-card,
      .duel-deck .sp-card,
      .sp-card {
        width: 100%;
        aspect-ratio: 3 / 4.4;
        min-height: 0;

        position: relative;
        overflow: hidden;

        border-radius: 14px;
        box-shadow:
          0 6px 18px rgba(0,0,0,.6),
          inset 0 0 18px rgba(0,0,0,.75);

        transform: translateZ(0);
        will-change: transform;
        padding: 6px;
      }
    }
  

/* =========================================================
   PATCH: Inner frame (the one you pointed) follows rarity for ALL cards
   Targets the metal inner frame drawn by .sp-card::before
   ========================================================= */

/* 1) Normalize rarity variables for BOTH formats:
      - class: .R1..R6 (ÑÐº Ñƒ Ñ„Ñ€Ð°ÐºÑ†Ñ–Ð¹Ð½Ð¸Ñ… ÐºÐ°Ñ€Ñ‚)
      - class/data: .common/.uncommon/.rare/.epic/.legend/.legendary/.mythic (ÑÐº Ñƒ JSON)
*/
.sp-card.R1, .sp-card.common,   .sp-card[data-rarity="common"]   { --rar-border: var(--r1); --rar: var(--r1); }
.sp-card.R2, .sp-card.uncommon, .sp-card[data-rarity="uncommon"] { --rar-border: var(--r2); --rar: var(--r2); }
.sp-card.R3, .sp-card.rare,     .sp-card[data-rarity="rare"]     { --rar-border: var(--r3); --rar: var(--r3); }
.sp-card.R4, .sp-card.epic,     .sp-card[data-rarity="epic"]     { --rar-border: var(--r4); --rar: var(--r4); }
.sp-card.R5, .sp-card.legend, .sp-card.legendary,
.sp-card[data-rarity="legend"], .sp-card[data-rarity="legendary"] { --rar-border: var(--r5); --rar: var(--r5); }
.sp-card.R6, .sp-card.mythic,   .sp-card[data-rarity="mythic"]   { --rar-border: var(--r6); --rar: var(--r6); }

/* 2) Make the inner metal frame more "colored" (less grey/black mix) for ALL cards */
.sp-card::before{
  /* Ð³Ð¾Ð»Ð¾Ð²Ð½Ðµ: Ñ†ÐµÐ¹ inset Ñ– Ñ” Ñ‚Ð²Ð¾Ñ â€œÐ²Ð½ÑƒÑ‚Ñ€Ñ–ÑˆÐ½Ñ Ñ€Ð°Ð¼ÐºÐ°â€ */
  box-shadow:
    inset 0 0 0 3px color-mix(in srgb, var(--rar-border) 92%, rgba(0,0,0,.25)),
    inset 0 0 30px rgba(0,0,0,.70),
    0 0 18px color-mix(in srgb, var(--rar) 40%, transparent);
  filter: saturate(1.45) contrast(1.08);
}

/* =========================================================
   DUEL SEARCH ANIMATION
   ========================================================= */

.duel-search-overlay{
  position: fixed;
  inset: 0;
  background: radial-gradient(
    circle at center,
    rgba(0,0,0,.85),
    rgba(0,0,0,.95)
  );
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
}

.duel-search-overlay.hidden{
  display: none;
}

.duel-search-box{
  text-align: center;
  color: var(--ink);
}

.search-ring{
  width: 120px;
  height: 120px;
  border-radius: 50%;
  border: 3px solid rgba(242,208,122,.25);
  border-top-color: var(--brass-1);
  animation: spin 1.2s linear infinite, pulse 2.2s ease-in-out infinite;
  margin: 0 auto 20px;
  box-shadow: 0 0 30px rgba(242,208,122,.35);
}

.search-text{
  font-size: 18px;
  letter-spacing: .5px;
}

@keyframes spin{
  to { transform: rotate(360deg); }
}

@keyframes pulse{
  0%,100% { box-shadow: 0 0 20px rgba(242,208,122,.25); }
  50%     { box-shadow: 0 0 40px rgba(242,208,122,.55); }
}

/* =========================================================
   CARD ATTACK ANIMATION
   ========================================================= */

.sp-card{
  will-change: transform, box-shadow;
}

/* ÐºÐ°Ñ€Ñ‚Ð°-Ð°Ñ‚Ð°ÐºÑƒÑŽÑ‡Ð° */
.sp-card.attacking{
  z-index: 50;
  transition: transform 0.28s ease-out;
}

/* ÐºÐ°Ñ€Ñ‚Ð°-Ñ†Ñ–Ð»ÑŒ */
.sp-card.defending{
  animation: defendHit 0.28s ease-out;
}

@keyframes defendHit{
  0%   { transform: translateX(0) scale(1); }
  30%  { transform: translateX(-6px) scale(0.97); }
  60%  { transform: translateX(6px) scale(0.98); }
  100% { transform: translateX(0) scale(1); }
}

/* ÑÐ¿Ð°Ð»Ð°Ñ… Ð¿Ñ€Ð¸ ÑƒÐ´Ð°Ñ€Ñ– */
.sp-card.hit-flash::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius: inherit;
  background: radial-gradient(circle, rgba(255,220,140,.45), transparent 60%);
  pointer-events:none;
  animation: hitFlash .25s ease-out;
}

@keyframes hitFlash{
  from { opacity:1; }
  to   { opacity:0; }
}

/* (Ð¾Ð¿Ñ†Ñ–Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) ÐºÑƒÑ€ÑÐ¾Ñ€ "Ð·Ð°Ð±Ð»Ð¾ÐºÐ¾Ð²Ð°Ð½Ð¾" */
body.duel-locked .sp-card{
  pointer-events: none;
  cursor: default;
}

/* ===== ANIMATIONS ===== */
@keyframes cardAttack {
  0% {
    transform: translateY(0) scale(1);
    filter: brightness(1) drop-shadow(0 0 0 rgba(255, 100, 100, 0));
  }
  25% {
    transform: translateY(-30px) scale(1.1);
    filter: brightness(1.5) drop-shadow(0 0 20px rgba(255, 100, 100, 0.8));
  }
  50% {
    transform: translateY(15px) scale(0.95);
    filter: brightness(1.8) drop-shadow(0 0 30px rgba(255, 100, 100, 1));
  }
  75% {
    transform: translateY(-10px) scale(1.05);
    filter: brightness(1.5) drop-shadow(0 0 20px rgba(255, 100, 100, 0.8));
  }
  100% {
    transform: translateY(0) scale(1);
    filter: brightness(1) drop-shadow(0 0 0 rgba(255, 100, 100, 0));
  }
}

@keyframes cardHit {
  0% {
    transform: scale(1);
    filter: brightness(1);
  }
  25% {
    transform: scale(1.15);
    filter: brightness(1.5);
  }
  50% {
    transform: scale(0.9);
    filter: brightness(0.7);
  }
  75% {
    transform: scale(1.05);
    filter: brightness(1.2);
  }
  100% {
    transform: scale(1);
    filter: brightness(1);
  }
}

@keyframes damageNumber {
  0% {
    opacity: 0;
    transform: translateY(0) scale(0.5);
  }
  20% {
    opacity: 1;
    transform: translateY(-20px) scale(1.2);
  }
  40% {
    opacity: 1;
    transform: translateY(-40px) scale(1);
  }
  80% {
    opacity: 0.8;
    transform: translateY(-60px) scale(0.9);
  }
  100% {
    opacity: 0;
    transform: translateY(-80px) scale(0.8);
  }
}

@keyframes elementEffect {
  0% {
    transform: scale(0);
    opacity: 0;
  }
  50% {
    transform: scale(1.5);
    opacity: 0.8;
  }
  100% {
    transform: scale(2);
    opacity: 0;
  }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
  20%, 40%, 60%, 80% { transform: translateX(5px); }
}

/* Attack animations */
.card-attacking {
  animation: cardAttack 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
  z-index: 100 !important;
  position: relative;
}

.card-hit {
  animation: cardHit 0.6s ease !important;
}

.card-shake {
  animation: shake 0.5s ease !important;
}

/* Damage number */
.damage-number {
  position: absolute;
  font-family: 'Cinzel', serif;
  font-weight: 900;
  font-size: 28px;
  color: #ff4444;
  text-shadow: 
    0 0 10px rgba(255, 0, 0, 0.8),
    0 0 20px rgba(255, 0, 0, 0.6),
    0 0 30px rgba(255, 0, 0, 0.4);
  z-index: 1000;
  pointer-events: none;
  animation: damageNumber 1s ease-out forwards;
}

/* Element effects */
.element-effect {
  position: absolute;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  pointer-events: none;
  z-index: 999;
  animation: elementEffect 0.8s ease-out forwards;
}

.fire-effect {
  background: radial-gradient(circle, #ff6a2b, transparent 70%);
  box-shadow: 0 0 40px #ff6a2b;
}

.water-effect {
  background: radial-gradient(circle, #4aa0d6, transparent 70%);
  box-shadow: 0 0 40px #4aa0d6;
}

.earth-effect {
  background: radial-gradient(circle, #5fbf6b, transparent 70%);
  box-shadow: 0 0 40px #5fbf6b;
}

.air-effect {
  background: radial-gradient(circle, #c9d2d9, transparent 70%);
  box-shadow: 0 0 40px #c9d2d9;
}

/* Attack line */
.attack-line {
  position: absolute;
  height: 3px;
  background: linear-gradient(90deg, #ff4444, #ff9966);
  box-shadow: 0 0 10px rgba(255, 100, 100, 0.8);
  transform-origin: left center;
  z-index: 99;
  pointer-events: none;
}

/* Duel arena positioning for animations */
.duel-arena {
  position: relative;
  min-height: 400px;
}

.player-hand, .enemy-hand {
  position: relative;
  z-index: 10;
}

/* =========================================================
   FLY-TO-TARGET HIT (power-scaled)
   ========================================================= */

body.duel-anim-lock .sp-card,
body.duel-anim-lock button{
  pointer-events: none;
}

.duel-clone{
  position: fixed;
  left: 0;
  top: 0;
  z-index: 4000;
  will-change: transform, filter, opacity;
  transform-origin: center center;
  pointer-events: none;
}

.duel-hit-flash{
  position: fixed;
  border-radius: 50%;
  pointer-events: none;
  z-index: 4500;
  background: radial-gradient(circle, rgba(255,220,140,.55), rgba(0,0,0,0) 65%);
  opacity: 0;
  will-change: transform, opacity;
}

@keyframes hitFlash {
  0%   { opacity: 0; transform: scale(.6); }
  20%  { opacity: .95; transform: scale(1.05); }
  100% { opacity: 0; transform: scale(1.7); }
}

.sp-card.duel-hit{
  animation: duelShake .22s ease-out;
  filter: brightness(1.15);
}

@keyframes duelShake{
  0%,100% { transform: translateX(0); }
  20% { transform: translateX(-4px); }
  40% { transform: translateX(5px); }
  60% { transform: translateX(-3px); }
  80% { transform: translateX(2px); }
}

/* =========================================================
   ORIGINAL CARD FLY ATTACK
   ========================================================= */

.duel-arena{
  position: relative;
}

.sp-card.attacking{
  z-index: 6000;
  will-change: transform, left, top;
}

/* ===== XP BAR ===== */
.xp-row {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.xp-bar {
  width: 100%;
  height: 10px;
  background: linear-gradient(180deg, #2b2416, #1a150c);
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid #5a4a2a;
}

.xp-bar-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(
    90deg,
    #c9a44a,
    #f1d27a
  );
  transition: width 0.4s ease;
}

.xp-value {
  font-size: 12px;
  text-align: right;
  color: #d6b86a;
}

.top-xp {
  height: 6px;
  background: #2a2212;
  border-radius: 6px;
  overflow: hidden;
}

.top-xp-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #c9a44a, #f1d27a);
  transition: width 0.4s ease;
}

/* ==============================
   TASKS
   ============================== */

.tasks-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.task-card {
  background: linear-gradient(180deg, #1b120c, #0e0905);
  border: 1px solid rgba(242,208,122,0.35);
  border-radius: 14px;
  padding: 12px;
  box-shadow: inset 0 0 20px rgba(0,0,0,.7);
}

.task-top {
  display: flex;
  justify-content: space-between;
  font-family: Cinzel, serif;
  color: #f2d07a;
  font-size: 14px;
}

.task-desc {
  margin: 6px 0 8px;
  font-size: 13px;
  color: #c9b37a;
}

.task-bar {
  height: 8px;
  background: #1a140b;
  border-radius: 6px;
  overflow: hidden;
}

.task-bar-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #7a5520, #f2d07a);
  transition: width .3s ease;
}

.task-reward {
  margin-top: 6px;
  font-size: 12px;
  color: #d6b86a;
}

.task-done {
  opacity: 0.45;
}

/* ===== PERF PATCH (mobile) ===== */
@media (max-width: 520px) {
  /* Ð¿Ñ€Ð¸Ð±Ñ€Ð°Ñ‚Ð¸ Ð²Ð°Ð¶ÐºÑ– ÐµÑ„ÐµÐºÑ‚Ð¸ Ð½Ð° Ð¼Ð°ÑÑ– ÐºÐ°Ñ€Ñ‚ */
  .card, .sp-card, .shop-card, .deck-card {
    box-shadow: none !important;
    filter: none !important;
  }

  /* ÑÐºÑ‰Ð¾ Ð´ÐµÑÑŒ Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑ”Ñ‚Ðµ backdrop-filter â€” Ð½Ð° Ð¼Ð¾Ð±Ñ–Ð»ÑŒÐ½Ð¾Ð¼Ñƒ ÐºÑ€Ð°Ñ‰Ðµ Ð²Ð¸Ð¼ÐºÐ½ÑƒÑ‚Ð¸ */
  .modal, .panel, .hud {
    backdrop-filter: none !important;
  }
}

/* ÐŸÑ–Ð´ÐºÐ°Ð·ÐºÐ° Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ñƒ: Ð°Ð½Ñ–Ð¼Ð°Ñ†Ñ–Ñ— Ñ‚Ñ–Ð»ÑŒÐºÐ¸ Ñ‡ÐµÑ€ÐµÐ· transform/opacity */
.card, .sp-card, .deck-card {
  will-change: transform, opacity;
  transform: translateZ(0);
}

/* Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÑ”Ð¼Ð¾: Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹Ñ‚Ðµ uiSetText()/uiToggleClass() Ð·Ð°Ð¼Ñ–ÑÑ‚ÑŒ Ð¿Ñ€ÑÐ¼Ð¾Ð³Ð¾ .textContent/.classList.toggle */

